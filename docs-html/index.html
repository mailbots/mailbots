<!doctype html>
<html>
<head>
  <meta charset='utf-8' />
  <title>mailbots 0.2.3-beta | Documentation</title>
  <meta name='viewport' content='width=device-width,initial-scale=1'>
  <link href='assets/bass.css' type='text/css' rel='stylesheet' />
  <link href='assets/style.css' type='text/css' rel='stylesheet' />
  <link href='assets/github.css' type='text/css' rel='stylesheet' />
  <link href='assets/split.css' type='text/css' rel='stylesheet' />
  <meta name='description' content='An open source bot framework for creating email-based bots using MailBots.com'>
</head>
<body class='documentation m0'>
    <div class='flex'>
      <div id='split-left' class='overflow-auto fs0 height-viewport-100'>
        <div class='py1 px2'>
          <h3 class='mb0 no-anchor'>mailbots</h3>
          <div class='mb1'><code>0.2.3-beta</code></div>
          <input
            placeholder='Filter'
            id='filter-input'
            class='col12 block input'
            type='text' />
          <div id='toc'>
            <ul class='list-reset h5 py1-ul'>
              
                
                <li><a
                  href='#intro'
                  class="h5 bold black caps">
                  intro
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#bot'
                  class="h5 bold black caps">
                  bot
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#mailbots'
                  class="h5 bold black caps">
                  mailbots
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#mailbots'
                  class=" toggle-sibling">
                  MailBots
                  <span class='icon'>‚ñ∏</span>
                </a>
                
                <div class='toggle-target display-none'>
                  
                  
                    <ul class='list-reset py1-ul pl1'>
                      <li class='h5'><span>Instance members</span></li>
                      
                      <li><a
                        href='#mailbotslisten'
                        class='regular pre-open'>
                        #listen
                      </a></li>
                      
                      <li><a
                        href='#mailbotsexportapp'
                        class='regular pre-open'>
                        #exportApp
                      </a></li>
                      
                      <li><a
                        href='#mailbotsloadskill'
                        class='regular pre-open'>
                        #loadSkill
                      </a></li>
                      
                      <li><a
                        href='#mailbotson'
                        class='regular pre-open'>
                        #on
                      </a></li>
                      
                      <li><a
                        href='#mailbotsoncommand'
                        class='regular pre-open'>
                        #onCommand
                      </a></li>
                      
                      <li><a
                        href='#mailbotsontrigger'
                        class='regular pre-open'>
                        #onTrigger
                      </a></li>
                      
                      <li><a
                        href='#mailbotsonevent'
                        class='regular pre-open'>
                        #onEvent
                      </a></li>
                      
                      <li><a
                        href='#mailbotsonaction'
                        class='regular pre-open'>
                        #onAction
                      </a></li>
                      
                      <li><a
                        href='#mailbotsontaskviewed'
                        class='regular pre-open'>
                        #onTaskViewed
                      </a></li>
                      
                      <li><a
                        href='#mailbotsonsettingsviewed'
                        class='regular pre-open'>
                        #onSettingsViewed
                      </a></li>
                      
                      <li><a
                        href='#mailbotsbeforesettingssaved'
                        class='regular pre-open'>
                        #beforeSettingsSaved
                      </a></li>
                      
                    </ul>
                  
                  
                  
                </div>
                
                </li>
              
                
                <li><a
                  href='#botwebhook'
                  class="">
                  bot.webhook
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#get'
                  class="">
                  get
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#set'
                  class="">
                  set
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#gettaskdata'
                  class="">
                  getTaskData
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#settaskdata'
                  class="">
                  setTaskData
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#getmailbotdata'
                  class="">
                  getMailBotData
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#setmailbotdata'
                  class="">
                  setMailBotData
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#getreferenceemail'
                  class="">
                  getReferenceEmail
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#setreferenceemail'
                  class="">
                  setReferenceEmail
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#getreplyto'
                  class="">
                  getReplyTo
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#getemailmethod'
                  class="">
                  getEmailMethod
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#sendemail'
                  class="">
                  sendEmail
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#quickreply'
                  class="">
                  quickReply
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#settriggertime'
                  class="">
                  setTriggerTime
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#settriggertimestamp'
                  class="">
                  setTriggerTimestamp
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#invite'
                  class="">
                  invite
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#completetask'
                  class="">
                  completeTask
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#getallcontacts'
                  class="">
                  getAllContacts
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#respond'
                  class="">
                  respond
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#settingspage'
                  class="">
                  settingsPage
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#botwebooksettingspage'
                  class="">
                  bot.webook.settingsPage
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#getsettingsformjson'
                  class="">
                  getSettingsFormJSON
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#insert'
                  class="">
                  insert
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#input'
                  class="">
                  input
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#textarea'
                  class="">
                  textarea
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#checkbox'
                  class="">
                  checkbox
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#select'
                  class="">
                  select
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#alert'
                  class="">
                  alert
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#video'
                  class="">
                  video
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#text'
                  class="">
                  text
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#hiddeninput'
                  class="">
                  hiddenInput
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#submitbutton'
                  class="">
                  submitButton
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#populate'
                  class="">
                  populate
                  
                </a>
                
                </li>
              
            </ul>
          </div>
          <div class='mt1 h6 quiet'>
            <a href='https://documentation.js.org/reading-documentation.html'>Need help reading this?</a>
          </div>
        </div>
      </div>
      <div id='split-right' class='relative overflow-auto height-viewport-100'>
        
          
            <div class='keyline-top-not py2'>
  <section class='py2 clearfix'>

    <h2 id='intro' class='mt0'>
      intro
    </h2>

    
      <p><a href="https://www.mailbots.com">MailBots</a> is a platform for creating bots, AIs and assistants that get things done right from your inbox. Read more at <a href="https://www.mailbots.com">mailbots.com</a>.</p>
<h1>Quick Start</h1>
<p>Go to mailbots.com and create a MailBot. The bot creation process sets up a working instance of this framework.</p>
<p>Next, let's tell our MailBot what to do when it receives an email:</p>
<pre class='hljs'><span class="hljs-keyword">var</span> MailBot = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mailbots"</span>);
<span class="hljs-keyword">var</span> mailbot = <span class="hljs-keyword">new</span> MailBot(); <span class="hljs-comment">// assuming .env is set</span>

<span class="hljs-comment">// When someone emails: say-hi@my-bot.eml.bot, respond "Hello Human!"</span>
mailbot.onCommand(<span class="hljs-string">"say-hi"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  bot.webhook.quickReply(<span class="hljs-string">"Hello Human!"</span>);
  bot.webhook.respond();
});

mailbot.listen();</pre>
<p><code>say-hi@my-bot.eml.bot</code> is an example of an "email command". Whatever is before the @ sign is a command to your bot to accomplish some task. <a href="https://docs.mailbots.com/reference#email-commands">Read more about email commands</a>.</p>
<h1>Docs</h1>
<p>Tip: Use our <a href="https://mailbots-app.mailbots.com">reference guide</a> to quickly look up helpers and method names.</p>
<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
<ul>
<li>
<p><a href="#how-mailbots-work">How MailBots Work</a></p>
<ul>
<li><a href="#tasks">Tasks</a></li>
<li><a href="#commands">Commands</a></li>
<li><a href="#triggering">Triggering</a></li>
<li><a href="#architecture">Architecture</a></li>
<li><a href="#handlers">Handlers</a></li>
<li><a href="#skills">Skills</a></li>
</ul>
</li>
<li>
<p><a href="#examples">Examples:</a></p>
<ul>
<li><a href="#hello-world">Hello World</a></li>
<li><a href="#set-a-reminder">Set a Reminder</a></li>
<li><a href="#handle-action-emails">Handle Action-Emails</a></li>
<li><a href="#install-a-skill">Install A Skill</a></li>
</ul>
</li>
<li>
<p><a href="#handler-reference">Handler Reference</a></p>
<ul>
<li><a href="#oncommand">onCommand</a></li>
<li><a href="#ontrigger">onTrigger</a></li>
<li><a href="#onaction">onAction</a></li>
<li><a href="#ontaskviewed">onTaskViewed</a></li>
<li><a href="#onevent">onEvent</a></li>
<li><a href="#onsettingsviewed">onSettingsViewed</a></li>
<li><a href="#beforesettingssaved">beforeSettingsSaved</a></li>
<li><a href="#on">on</a></li>
<li><a href="#handling-errors">Handling Errors</a></li>
</ul>
</li>
<li><a href="#the-bot-object">The "bot" Object</a></li>
<li>
<p><a href="#building-skills">Building Skills</a></p>
<ul>
<li><a href="#using-handlers">Using Handlers</a></li>
<li><a href="#the-one-bot-function">The "one-bot function"</a></li>
<li><a href="#handling-web-requests">Handling Web Requests</a></li>
<li><a href="#middleware">Middleware</a></li>
<li><a href="#namespacing-conventions">Namespacing Conventions</a></li>
</ul>
</li>
<li>
<p><a href="#installing-skills%C2%A0from-npm">Installing Skills¬†From npm</a></p>
<ul>
<li><a href="#skills-with-side-effects">Skills With Side-Effects</a></li>
</ul>
</li>
<li><a href="#welcoming-new-users">Welcoming New Users</a></li>
<li><a href="#testing">Testing</a></li>
<li><a href="#installing">Installing</a></li>
<li><a href="#contributions">Contributions</a></li>
</ul>
<!-- END doctoc generated TOC please keep comment here to allow auto update -->
<h1>How MailBots Work</h1>
<p>A MailBot's purpose is to help someone get something done quickly, efficiently and without leaving their inbox.</p>
<h2>Tasks</h2>
<p>A unit of work accomplished by a MailBot is called a "task". Tasks can scheduled, edited or "completed". Tasks are always associated with a command.</p>
<h2>Commands</h2>
<p>MailBots always work in the context of commands while accomplishing tasks. A command can be thought of as the instruction for how to complete a particular task, or the purpose of the task. Email Commands (shown above) are one way to issue commands. Creating a task with the API also requires a command.</p>
<h2>Triggering</h2>
<p>A task (that carries out a command) can be created then wait for the perfect moment to notify a user. Timliness is a core feature of of a MailBot.</p>
<h2>Architecture</h2>
<p>When events happen in the MailBots platform (ex: an email is received), your MailBot receives webhooks. Your MailBot then gets some useful bit of work done (ex: enters data into a CRM) and responds with JSON that tells the MailBots platform what to do next (ex: send an email, store data, set a reminder, etc). JSON in, JSON out.</p>
<p>This library simplifies much of the above architecture, allowing you to simply create handler functions for certain events.</p>
<p>The webhook request and response can be viewed via the <a href="https://app.mailbots.com/sandbox">MailBots Sandbox</a>.</p>
<h2>Handlers</h2>
<p>MailBots are composed of handlers ‚Äì functions that run when certain events occur. For example: <em>When the bot receives an email at this address, execute these actions</em></p>
<h2>Skills</h2>
<p>Handlers and other bot functionality can be packaged into "skills" ‚Äì high-level abilities that can shared between bots. Here are some example skills:</p>
<ul>
<li>Interact with a CRM</li>
<li>Parse natural language</li>
<li>Send a text message or Slack message</li>
<li>Render special UI elements</li>
</ul>
<p>You can publish, share and install new skills from npm.</p>
<h1>Examples:</h1>
<h2>Hello World</h2>
<p>Create an <a href="https://docs.mailbots.com/reference#email-commands">email command</a> that says hi.</p>
<pre class='hljs'><span class="hljs-keyword">var</span> MailBotsApp = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mailbots"</span>);
<span class="hljs-keyword">var</span> app = <span class="hljs-keyword">new</span> MailBotsApp();

mailbot.onCommand(<span class="hljs-string">"hi"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  bot.webhook.quickReply(<span class="hljs-string">"Hi back!"</span>);
  bot.webhook.respond();
});

mailbot.listen();</pre>
<h2>Set a Reminder</h2>
<p>The first handler creates the reminder. The second one handles the reminder when it becomes due.</p>
<pre class='hljs'>mailbot.onCommand(<span class="hljs-string">"hi"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// Schedule the task to trigger in 1 minute</span>
  bot.webhook.setTriggerTime(<span class="hljs-string">"1min"</span>);
  bot.webhook.respond();
});

<span class="hljs-comment">// When a task with "hi" command triggers, run this</span>
mailbot.onTrigger(<span class="hljs-string">"hi"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  bot.webhook.quickReply(<span class="hljs-string">"Hi 1 minute later!"</span>);
  bot.webhook.respond();
});</pre>
<h2>Handle Action-Emails</h2>
<p>MailBots can render quick-action buttons (mailto links that map to executable code) that let users get things done without leaving their inbox. Read more about <a href="https://docs.mailbots.com/reference#email-based-actions">action emails</a>.</p>
<pre class='hljs'><span class="hljs-comment">// This first handler renders an email¬†with an action-email button</span>
 mailbot.onCommand(<span class="hljs-string">"send-buttons"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
    bot.webhook.sendEmail({
      <span class="hljs-attr">to</span>: bot.get(<span class="hljs-string">'source.from'</span>)
      <span class="hljs-keyword">from</span>: <span class="hljs-string">"MyBot"</span>,
      <span class="hljs-attr">subject</span>: bot.get(<span class="hljs-string">'source.subject'</span>),
      <span class="hljs-attr">body</span>: [

        <span class="hljs-comment">// üëá An email-action</span>
        {
          <span class="hljs-attr">type</span>: <span class="hljs-string">"button"</span>,
          <span class="hljs-attr">behavior</span>: <span class="hljs-string">"action"</span>,
          <span class="hljs-attr">text</span>: <span class="hljs-string">"Press Me"</span>,
          <span class="hljs-attr">action</span>: <span class="hljs-string">'say.hi'</span>,
          <span class="hljs-attr">subject</span>: <span class="hljs-string">"Just hit 'send'"</span>,
        }
      ]
    });
    bot.webhook.respond();
  };

  <span class="hljs-comment">// This handler handles the email action</span>
  mailbot.onAction(<span class="hljs-string">'say.hi'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
    bot.webhook.quickReply(<span class="hljs-string">'hi'</span>);
    <span class="hljs-comment">// Lots of useful things can be done here. Completing a todo item, adding notes to a CRM, etc.</span>
    bot.webhook.respond();
  });

  mailbot.listen();</pre>
<h2>Install A Skill</h2>
<p>Let's install a skill to that extracts the email message from previously quoted emails and signatures.</p>
<pre class='hljs'><span class="hljs-keyword">var</span> mailbotsTalon = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mailbots-talon"</span>);
mailbot.onCommand(<span class="hljs-string">"hi"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-keyword">const</span> emailWithoutSignature = mailbotsTalon.getEmail(bot);
  bot.quickReply(
    <span class="hljs-string">"Here is the email without the signature:"</span> + emailWithoutSignature
  );
  bot.webhook.respond();
});</pre>
<h1>Handler Reference</h1>
<p>Note: The first matching event handler ends the request, even if subsequent handlers also match, except where otherwise noted.</p>
<h2>onCommand</h2>
<pre><code>mailbot.onCommand(command, handlerFn)
</code></pre>
<p>Handle when an <a href="https://docs.mailbots.com/reference">email command</a> is received. This also fires when a new task is created via the API (All tasks have a command to define their purpose or reason for existence.)</p>
<pre class='hljs'>mailbot.onCommand(<span class="hljs-string">"todo"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">//handle when a task is created with this command string</span>
});</pre>
<p>Regular expressions work with all handlers.</p>
<pre class='hljs'>mailbot.onCommand(<span class="hljs-regexp">/todo.*/</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">//Handle todo.me@my-ext.eml.bot, todo.you@my-ext.eml.bot, todo.everyone@my-ext.eml.bot</span>
});</pre>
<h2>onTrigger</h2>
<pre><code>mailbot.onTrigger(command, handlerFn)
</code></pre>
<p>Timeliness is a MailBot superpower. A user can schedule a task, then days, months or years later your bot can follow up at the exact right moment ‚Äì scheduled by the user, or by another event. Read more about <a href="https://docs.mailbots.com/reference#perfect-timing">triggering</a>.</p>
<p>Tasks with different commands may trigger differently. For example:</p>
<pre class='hljs'>mailbot.onTrigger(<span class="hljs-string">"todo.me"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// Assigned to myself, so only remind me</span>
});</pre>
<pre class='hljs'>mailbot.onTrigger(<span class="hljs-string">"todo.assign"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// Assigned to the person in the 'to' field, so remind them</span>
});</pre>
<pre class='hljs'>mailbot.onTrigger(<span class="hljs-string">"todo.crm"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// Query CRM API, populate email followup with contact data</span>
});</pre>
<h2>onAction</h2>
<pre><code>mailbot.onAction(action, handlerFn)
</code></pre>
<p>Handle when a user performs an action that relates to a task.</p>
<p>For example a user can send an <a href="https://docs.mailbots.com/reference#email-based-actions">action-email</a> to accomplish an action without leaving their inbox (postponing a reminder, completing a todo item, logging a call, etc).</p>
<pre class='hljs'>mailbot.onAction(<span class="hljs-string">"complete"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// Complete the related todo</span>
});</pre>
<p><strong>MailBot Conversations</strong></p>
<p>Set the reply-to address of a MailBot email to an action email to carry out a conversation with the user.</p>
<pre class='hljs'>mailbot.onAction(<span class="hljs-string">"assistant"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// Use luis-ai middlweare to dtermine intent</span>
  <span class="hljs-comment">// Store conversation state</span>
  <span class="hljs-comment">// send-email whose reply-to is also "assistant"</span>
});</pre>
<h2>onTaskViewed</h2>
<pre><code>mailbot.onTaskViewed(command, handlerFn)
</code></pre>
<p>Handle when a task is viewed in the MailBots Web UI, allowing a user to view and interact with a future MailBots email.</p>
<pre class='hljs'>mailbot.onTaskViewed(<span class="hljs-string">"todo.me"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// Show a preview of the future email</span>
});</pre>
<p>Different task commands may render differently. For example a task with command <code>todo.crm</code> may query and render current CRM data within the preview.</p>
<h2>onEvent</h2>
<pre><code>mailbot.onEvent(event, handlerFn)
</code></pre>
<p>Handle when the MailBot receives an inbound webhok from a 3rd party system about an external event. For example, a support ticket is created or a lead is added to a CRM.</p>
<p>Note: This action does not automatically create a MailBots Task. One can be created with <a href="https://www.npmjs.com/package/@mailbots/mailbots-sdk">mailbots-sdk</a></p>
<pre class='hljs'>mailbot.onEvent(<span class="hljs-string">"issue.created"</span>, <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// Handle event, for example, create a MailBots Task.</span>
  <span class="hljs-keyword">const</span> mailBotsClient = MailBotsClient.fromBot(bot);
  <span class="hljs-keyword">await</span> mailBotsClient.createTask({
    <span class="hljs-comment">// Pre-authenticated API client</span>
  });
  bot.webhook.respond({ <span class="hljs-attr">webhook</span>: { <span class="hljs-attr">status</span>: <span class="hljs-string">"success"</span> } });
});</pre>
<h2>onSettingsViewed</h2>
<pre><code>mailbot.onSettingsViewed(handlerFn)
</code></pre>
<p>Handle when a user views this MailBot's settings.</p>
<p>Bots can build custom settings pages. These are rendered when a user views bot settings on the MailBots.com admin UI.</p>
<p>See the <a href="https://mailbots-app.mailbots.com/#settingspage">settings page reference</a>.</p>
<p>The handler's only parameter is a callback function that responds with JSON to to render a settings form. The callback function is passed the <code>bot</code> object as usual.</p>
<p>Settings form JSON can be easily built using the <a href="https://mailbots-app.mailbots.com/#settingspage">settings helper functions</a>.</p>
<p>Unlike the other handlers, every instance of this handler is called. (ie, all settings pages from all settings handlers are rendered).</p>
<p>NOTE: Do not call <code>bot.webhook.respond()</code> at the end of this particular request. MailBots' internals take care of compiling the JSON and responding.</p>
<pre class='hljs'><span class="hljs-comment">// Render a settings field for the user to enter their first name</span>
mailbot.onSettingsViewed(<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-keyword">const</span> todoSettings = bot.webhook.settingsPage({
    <span class="hljs-attr">namespace</span>: <span class="hljs-string">"todo"</span>,
    <span class="hljs-attr">title</span>: <span class="hljs-string">"Todo Settings"</span>, <span class="hljs-comment">// Page title</span>
    menuTitle: <span class="hljs-string">"Todo"</span> <span class="hljs-comment">// Name of menu item</span>
  });
  todoSettings.input({ <span class="hljs-attr">name</span>: <span class="hljs-string">"first_name"</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">"First name"</span> });
  todoSettings.submitButton();

  <span class="hljs-comment">// Populate form values</span>
  todoSettings.populate(bot.get(<span class="hljs-string">"mailbot.stored_data.todo"</span>));
  <span class="hljs-comment">// Note bot.webhook.respond() is NOT called</span>
});</pre>
<p>URL parameters are passed through to the settings webhook. Use this to pass data into your settings when linking to it.</p>
<pre class='hljs'>mailbot.onSettingsViewed(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-keyword">const</span> settingsPage = bot.webhook.settingsPage({ <span class="hljs-attr">namespace</span>: <span class="hljs-string">"todo"</span> });

  <span class="hljs-keyword">if</span> (bot.get(<span class="hljs-string">"url_params.linkInstructions"</span>, <span class="hljs-literal">false</span>)) {
    settings.text(<span class="hljs-string">`# Instructions to link your account!`</span>);
  }
  <span class="hljs-comment">// Note that there is no submit button. It's just an informational page.</span>
});</pre>
<p>If you wish to use URL params in your <code>beforeSettingsSaved</code> handler (below), pass them via the <code>urlParams</code> key in the <code>submit</code> form element.</p>
<pre class='hljs'><span class="hljs-comment">// within a onSettingsViewed form as shown above</span>
settings.submitButton({
  <span class="hljs-attr">submitText</span>: <span class="hljs-string">"Save Notification Settings"</span>,
  <span class="hljs-attr">urlParams</span>: { <span class="hljs-attr">saveSettings</span>: <span class="hljs-number">1</span> }
  <span class="hljs-comment">// Tip: Pass through all URL current params, but use caution! (see note)</span>
  <span class="hljs-comment">// urlParams: {saveSettings: 1, ...bot.get("url_params", {})}</span>
});</pre>
<p>NOTE: URL parameters are an easy way to pass data into your bot settings, but <strong>keep this in mind while using URL params</strong>: Anyone can link a user to their settings page with <em>anything</em> in URL. Do not, for example, create a url like: <code>/settings?delete_everything=true</code> that deletes all their tasks. An unsuspecting user may arrive on their settings page from an external link, not see this in the URL and submit the form only find themselves without any data. <a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)">Read more</a>.</p>
<h2>beforeSettingsSaved</h2>
<pre><code>mailbot.beforeSettingsSaved(handlerFn)
</code></pre>
<p>Handle when the user saves their settings. Called before settings are actually saved.</p>
<p>Similar to the above <code>onSettingsViewed</code> handler, every instance of this handler is called when settings are saved.</p>
<p>Validate user data, perform API calls to keep other systems in sync. Return an error
to abort saving the settings.</p>
<pre class='hljs'>mailbot.beforeSettingsSaved(<span class="hljs-function"><span class="hljs-params">bot</span> =&gt;</span> {
  <span class="hljs-comment">// assuming the same "todo" namespace as shown in the above examples</span>
  <span class="hljs-keyword">const</span> data = bot.get(<span class="hljs-string">"settings.todo"</span>);

  <span class="hljs-comment">// handler is fired any times settings are saved, even if its not our form</span>
  <span class="hljs-keyword">if</span> (!data) <span class="hljs-keyword">return</span>;

  <span class="hljs-comment">// perform API calls, update external systems, etc. If something goes wrong...</span>
  <span class="hljs-keyword">if</span> (error) {
    <span class="hljs-comment">// abort the saving process</span>
    <span class="hljs-keyword">return</span> bot.webhook.respond({
      <span class="hljs-attr">webhook</span>: {
        <span class="hljs-attr">status</span>: <span class="hljs-string">"error"</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">"This is  a warning message"</span>
      }
    });
  }

  <span class="hljs-comment">// Othwise, it implicitly returns success, and the saving process continues</span>
});</pre>
<h2>on</h2>
<pre><code>mailbot.on(webhookEvent, handlerFn)
</code></pre>
<p>This is a generic handler for any webhook. It can be used to handle any inbound webhook ‚Äì¬†mainly ones that are not covered by the handlers above. (Of note: The handlers above are simply wrappers for this lower-level handler).</p>
<p>Example:</p>
<pre class='hljs'>mailbot.on(<span class="hljs-string">"mailbot.installed"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// Handle when a MailBot is installed</span>
  <span class="hljs-comment">// Create task with MailBots SDK</span>
  <span class="hljs-comment">// bot.webhook.respond();</span>
});</pre>
<p>The first paramater can be:</p>
<ul>
<li>A string that matches the webhook <code>type</code>. (ie. <a href="https://docs.mailbots.com/reference#mailbotinstalled"><code>mailbot.installed</code></a>)</li>
<li>A regular expression that matches on webhook <code>type</code></li>
<li>A function that takes the incoming webhook as the only parameter and returns a boolean value indicating whether or not that webhook should be handled by that function handler.</li>
</ul>
<p>The second parameter is the function handler that runs only if the matching condition (the first parameter) is met.</p>
<pre class='hljs'>mailbot.on(<span class="hljs-string">"mailbot.installed"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// Handle when a MailBot is installed</span>
  <span class="hljs-comment">// Create a task from mailbots sdk</span>
  <span class="hljs-comment">// bot.webhook.respond();</span>
});</pre>
<h2>Handling Errors</h2>
<p>Ideally, error conditions are handled within the normal application flow. If something unexpected happens you can set up a custom error handler for adding logs, alerting or providing error messaging to users.</p>
<p>If you want to send the user your own error email, use the <a href="https://mailbots-sdk-js.mailbots.com/#sendemaill">sendEmail</a> method from the MailBots SDK. (Not all webhook responses send emails).</p>
<pre class='hljs'><span class="hljs-comment">// define a custom error handler</span>
app.setErrorHandler(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error, bot</span>) </span>{
  <span class="hljs-comment">// myCustomLogger.log(error);</span>
  <span class="hljs-comment">// send email with mailbots sdk</span>
  <span class="hljs-comment">// send a custom error email to user</span>
  <span class="hljs-comment">// Respond with 5xx status code to send the generic MailBots error email to the user</span>
  <span class="hljs-comment">// bot.response.status(500);</span>

  bot.webhook.respond({
    <span class="hljs-attr">status</span>: <span class="hljs-string">"error"</span>,
    <span class="hljs-attr">message</span>: <span class="hljs-string">"A custom error message"</span> <span class="hljs-comment">// Shown to user if in the web UI.</span>
  }); <span class="hljs-comment">// A webhook response must be sent</span>
});</pre>
<h1>The "bot" Object</h1>
<p>The <code>bot</code> object passed to the handlers above contains useful helpers that make it easy to handle bot requests. See <a href="https://mailbots-app.mailbots.com/#webhookhelpers">webhook helpers reference docs</a>.</p>
<p><strong>Setting Data Works By Shallow Merging</strong>
Data is set by shallow merging. For example.</p>
<pre class='hljs'>bot.webhook.setTaskData(<span class="hljs-string">"my_namespace"</span>, { <span class="hljs-attr">name</span>: <span class="hljs-string">"Joe"</span> });
bot.webhook.setTaskData(<span class="hljs-string">"my_namespace"</span>, { <span class="hljs-attr">key</span>: <span class="hljs-string">"123"</span> });
<span class="hljs-comment">// task data is now</span>
<span class="hljs-built_in">console</span>.log(bot.webhook.responseJson);
<span class="hljs-comment">// {my_namespace: { name: "Joe", key: "123" }}</span></pre>
<pre class='hljs'>bot.webhook.setTaskData(<span class="hljs-string">"my_namespace"</span>, {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Joe"</span>,
  <span class="hljs-attr">data</span>: { <span class="hljs-attr">value</span>: <span class="hljs-string">"here"</span> } <span class="hljs-comment">// ‚ö†Ô∏è Overwritten (shallow merge)</span>
});
bot.webhook.setTaskData(<span class="hljs-string">"my_namespace"</span>, {
  <span class="hljs-attr">data</span>: { <span class="hljs-attr">value2</span>: <span class="hljs-string">"there"</span> }
});
<span class="hljs-comment">// task data is now</span>
<span class="hljs-built_in">console</span>.log(bot.webhook.responseJson);
<span class="hljs-comment">// {my_namespace: { data: { value2: "there" } }}</span></pre>
<h1>Building Skills</h1>
<p>"Skills" are sharable pieces of bot functionality. Skills can encapsulate everything they need (handlers, settings panels helper funcitons and UI elements) into a package that "just works" when installed. They are great for keeping your code organized and for sharing functionality with others.</p>
<p>A skill can share functionality in several ways:</p>
<h2>Using Handlers</h2>
<p>We could better organize our handlers in the above examples by grouping them into different files. For example:</p>
<pre class='hljs'><span class="hljs-comment">// my-new-reminder-skill.js</span>
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">mailbot</span>) </span>{
  <span class="hljs-comment">// Handlers can go here</span>
  <span class="hljs-comment">// mailbot.onCommand...</span>
};</pre>
<p>It can be loaded like this:</p>
<pre class='hljs'><span class="hljs-comment">// In top-level app.js</span>
<span class="hljs-built_in">require</span>(<span class="hljs-string">"./my-new-skill"</span>)(mailbot);</pre>
<p>Once loaded, all handlers within the file become active.</p>
<p>A directory of skill files (like the one above) can be loaded using the <code>loadSkill</code> helper:</p>
<pre class='hljs'><span class="hljs-comment">// Load all skill files in a directory</span>
mailbot.loadSkill(__dirname + <span class="hljs-string">"/my/skill/"</span>);</pre>
<p><code>loadSkill</code> only looks for skill files in the top-level directory. This allows a skill to hide¬†its implementation details in subdirectories.</p>
<p>A config object can optionally be passed.</p>
<pre class='hljs'><span class="hljs-comment">// app.js</span>
mailbot.loadSkill(__dirname + <span class="hljs-string">"/my/skills/"</span>, config);</pre>
<pre class='hljs'><span class="hljs-comment">// skill-file.js</span>
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">mailbot, config</span>) </span>{
  <span class="hljs-comment">// All of your handlers can go here</span>
};</pre>
<p>Grouping your handlers into skills is a great way to keep your project organized. The down-side is that the skill owns each request from beginning to end ‚Äì not very flexible.</p>
<p>The next section covers a more granular and composable technique for sharing functionality across multiple handlers or multiple MailBots.</p>
<h2>The "one-bot function"</h2>
<p>A "one-bot function" is a function that takes a single <code>bot</code> object (an instance of BotRequest) which, itself, contains the request / response state and utilities to alter the request. It is one instance of a bot request, hence, a one-bot function.</p>
<p>One-bot functions are called within handlers, allowing for a top-level handler to compose multiple one-bot functions to get something done.</p>
<pre class='hljs'><span class="hljs-comment">// sayHi.js</span>
<span class="hljs-comment">// A simple "one-bot function"</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sayHi</span>(<span class="hljs-params">bot</span>) </span>{
  bot.webhook.quickReply(<span class="hljs-string">"hi"</span>);
}
<span class="hljs-built_in">module</span>.exports = sayHi;</pre>
<pre class='hljs'><span class="hljs-comment">// in main app.js</span>
<span class="hljs-keyword">const</span> sayHi = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./sayHi.js"</span>);
<span class="hljs-comment">//...</span>
mailbots.onCommand(<span class="hljs-string">"hi"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  sayHi(bot);
  bot.webhook.respond();
});</pre>
<p>You can, of course, use both the one-bot function and a handler within one skill:</p>
<pre class='hljs'><span class="hljs-comment">// my-reminder-skill.js</span>
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">mailbot</span>) </span>{
  <span class="hljs-comment">// Handles all triggering for this MailBot (/.*/ matches anything)</span>
  mailbot.onTrigger(<span class="hljs-regexp">/.*/</span>, funciton(bot) {
    <span class="hljs-comment">// Do some useful things, send emails,etc.</span>
    bot.webhook.respond();
  });

  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">remindTomorrow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
        bot.webhook.setTriggerTime(<span class="hljs-string">"tomorrow"</span>);
    }
  };
};</pre>
<pre class='hljs'><span class="hljs-comment">// Use the reminder skill</span>
<span class="hljs-keyword">const</span> { remindTomorrow } = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./my-reminder-skill"</span>)(mailbot);

mailbot.onCommand(<span class="hljs-string">"whatever-custom-command"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// Set a reminder. When due, the skill automatically handles it.</span>
  remindTomorrow(bot);
  bot.webhook.respond();
});</pre>
<h3>Sharing UI Elements</h3>
<p>Skills can use one-bot functions to share <a href="https://docs.mailbots.com/docs/email-ui-reference">UI elements</a>.</p>
<p>By convention, UI functions that output UI start with <code>render</code>. For example, <code>renderMemorizationControls</code>.</p>
<pre class='hljs'>  <span class="hljs-keyword">var</span> memorizeSkill = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mailbots-memorize"</span>)(mailbot);
  mailbot.onCommand(<span class="hljs-string">"remember"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
    bot.webhook.sendEmail({
      <span class="hljs-attr">to</span>: <span class="hljs-string">"you@email.com"</span>
      <span class="hljs-keyword">from</span>: <span class="hljs-string">"MailBots"</span>,
      <span class="hljs-attr">subject</span>: <span class="hljs-string">"Email Subject"</span>
      body: [
        {
          <span class="hljs-attr">type</span>: <span class="hljs-string">'title'</span>,
          <span class="hljs-attr">text</span>: <span class="hljs-string">'A Title'</span>
        },

        <span class="hljs-comment">// Render JSON UI</span>
        memorizeSkill.renderMemorizationControls(bot)
      ]
    })
    bot.webhook.respond();
  }</pre>
<h2>Handling Web Requests</h2>
<p>The <code>mailbots</code> framework relies on Express.js for many of its internals. Your skill can access the internal Express <code>app</code> object at <code>mailbot.app</code>, allowing your skill to do anything that can be done with Express: authenticate other services, interact with APIs, respond to webhooks and render web pages.</p>
<p>Just like in <a href="https://expressjs.com/en/guide/routing.html">handling routes in Express</a>:</p>
<pre class='hljs'>mailbot.app.get(<span class="hljs-string">"/hi"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>{
  res.send(<span class="hljs-string">"&lt;h1&gt;Hi http request!&lt;/h1&gt;"</span>);
});</pre>
<h2>Middleware</h2>
<p><a href="https://expressjs.com/en/guide/writing-middleware.html">Middlware</a> can be exported and "used" by other skills. This is useful for implementing common functionality across multiple handlers.</p>
<pre class='hljs'><span class="hljs-comment">// Export middleware to log everything</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logEverythingMiddleware</span>(<span class="hljs-params">req, res, next</span>) </span>{
  <span class="hljs-keyword">const</span> bot = res.locals.bot; <span class="hljs-comment">// bot lives here</span>
  <span class="hljs-keyword">const</span> emailSubject = bot.get(<span class="hljs-string">"source.subject"</span>);
  <span class="hljs-built_in">require</span>(<span class="hljs-string">"my-great-logger"</span>).log(<span class="hljs-string">`Got an email about <span class="hljs-subst">${emailSubject}</span>`</span>);
  next(); <span class="hljs-comment">// &lt;-- Don't forget this!</span>
}
<span class="hljs-built_in">module</span>.exports = logEverythingMiddleware;
};</pre>
<pre class='hljs'><span class="hljs-comment">// Using our middleware</span>
<span class="hljs-keyword">const</span> logEverythingMiddleware = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./log-everything"</span>);

<span class="hljs-comment">// Apply to all subsequent handlers</span>
<span class="hljs-comment">// Note: It does not apply to earlier handlers</span>
mailbot.app.use(logEverythingMiddleware);

mailbot.onCommand(<span class="hljs-string">"command-one"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// everything is logged</span>
});
mailbot.onCommand(<span class="hljs-string">"command-two"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// everything is logged</span>
});
mailbot.onCommand(<span class="hljs-string">"command-three"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// everything is logged</span>
});</pre>
<h2>Namespacing Conventions</h2>
<p>To prevent conflicts and facilitate debugging, it is helpful to follow these conventions. For examples below, our skill is <code>skill-name</code>.</p>
<ul>
<li>
<p>The module¬†name</p>
<pre><code># Example module name
npm install mailbots-skill-name
</code></pre>
</li>
<li>
<p>Store data against the task or bot in a subject with key of the skill name using underscores instead of dashes.</p>
<pre class='hljs'>(task.stored_data = { "skill_name": { "key": "val" } })</pre>
</li>
<li>
<p>Preface event names and actions with the skill name or an abbreviation (accounting for <a href="http://www.rfc-editor.org/errata/eid1690">character limitations</a>)</p>
<pre class='hljs'>mailbots.onAction(<span class="hljs-string">"sn.do-action"</span>, bot =&gt; {});</pre>
<h3>Use of "MailBot", "mailbot", "MailBots" and "bots"</h3>
<p>For clarity and to reduce ambiguity, follow these conventions:</p>
<ul>
<li>User-Facing: The name of the platform (and company) is "MailBots". Always studly-cased. Always plural.</li>
<li>User-Facing: One email-based bot is a "MailBot". Always studly-cased.</li>
<li>Code: <code>mailbot</code> (all lowercased) is an acceptable variable name, but...</li>
<li>Code: When the first "M" is capitalized, always capitalize the second. Ex: <code>createMailBot()</code>. <code>Mailbot</code> (lowercase "b") never exists.</li>
<li>Code: <code>bot</code> is only used for the bot helper object passed to handler functions.</li>
</ul>
</li>
</ul>
<h1>Installing Skills¬†From npm</h1>
<p>Skills can be installed from npm.</p>
<p>Here we will use <code>mailbots-memorize</code>, a skill that creates reminders for any <a href="https://docs.mailbots.com/reference">task</a> using <a href="https://www.wikiwand.com/en/Spaced_repetition">spaced repetition</a>, a memorization technique that increases the time between reminders as more reminders are sent.</p>
<p>In your cli, run:</p>
<p><code>npm install --save mailbots-memorize</code></p>
<p>In our app.js file we will create a handler that uses our newly installed skill.</p>
<pre class='hljs'><span class="hljs-comment">// In main app.js file</span>
<span class="hljs-keyword">var</span> memorizeSkill = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mailbots-memorize"</span>)(mailbot);

mailbot.onCommand(<span class="hljs-string">"remember"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  memorizeSkill.memorizeTask(bot); <span class="hljs-comment">//  ‚¨Ö Tell bot to memorize your task</span>
  bot.webhook.quickResponse(<span class="hljs-string">"Memorizing!"</span>);
  bot.webhook.respond();
});

<span class="hljs-comment">// Called each time the reminder is triggered</span>
mailbot.onTrigger(<span class="hljs-string">"remember"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  memorizeSkill.memorizeTask(bot); <span class="hljs-comment">// ‚¨Ö Invoke skill to continue memorizing</span>
  bot.webhook.quickResponse(<span class="hljs-string">"An email with decreasing frequency"</span>);
  bot.webhook.respond();
});</pre>
<h2>Skills With Side-Effects</h2>
<p>Skills that accept the <code>mailbots</code> object may automatically alter requests, reply to webhooks or take other automatic action behind the scenes.</p>
<pre class='hljs'><span class="hljs-comment">// May automatically handle requets (ex, render settings pages, send emails)</span>
<span class="hljs-keyword">var</span> handleEverything = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mailbots-handle-everything"</span>);
handleEverything(mailbot);
<span class="hljs-comment">// or</span>
<span class="hljs-built_in">require</span>(<span class="hljs-string">"handleEverything"</span>)(mailbot);</pre>
<p>Skills that are not passed the <code>mailbot</code> object will export components (middleware, one-bot functions, etc) for you to explicitly use in your handlers.</p>
<pre class='hljs'><span class="hljs-comment">// These types of skills offer components to your handlers</span>
<span class="hljs-keyword">var</span> {
  someMiddleware,
  renderSomething
} = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mailbots-provide-components"</span>);

mailbots.app.use(someMiddleware);

mailbots.onCommand(<span class="hljs-string">"foo"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  doSomething(bot);
});</pre>
<p>Skills will, themselves, document how they are used. Different approaches are right for different circumstances.</p>
<h1>Welcoming New Users</h1>
<p>When a new user installs your MailBot, they are directed to a settings page with the <code>welcome</code> namespace. Render a custom welcome message for your user by creating a settings page that targets this namespace.</p>
<pre class='hljs'>mailbot.onSettingsViewed(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>)  </span>{
    <span class="hljs-keyword">const</span> welcomeSettings = bot.webhook.settingsPage({
      <span class="hljs-attr">namespace</span>: <span class="hljs-string">"welcome"</span>, <span class="hljs-comment">// MailBots sends new users to this namespace automatically</span>
      menuTitle: <span class="hljs-string">"Welcome"</span>
    });

    welcomeSettings.text(<span class="hljs-string">`
# Welcome To My MailBot
_Markdown_ works here.`</span>);
)}</pre>
<p>Note: While in dev_mode, the MailBot owner is instead redirected to the sandbox.</p>
<p>Your bot receives the <code>mailbot.installed</code> webhook which can be used to schedule a series of welcome emails to the user.</p>
<h1>Testing</h1>
<p>Export a testable instance of your MailBot by calling <code>mailbot.exportApp()</code> instead of calling <code>mailbot.listen()</code>. Below is an example of testing the exported app with <a href="https://www.npmjs.com/package/supertest">Supertest</a>.</p>
<p>For a sample request (the <code>./_fixtures/task.created.json</code> file below), fire a request and go to the sandbox. Click the "copy" icon that appears when you over over the the top-level key the request JSON.</p>
<p>Note: Set <code>NODE_ENV</code> to <code>testing</code> to disable webhook validation.</p>
<pre class='hljs'><span class="hljs-keyword">const</span> request = <span class="hljs-built_in">require</span>(<span class="hljs-string">"supertest"</span>);
<span class="hljs-keyword">const</span> mocha = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mocha"</span>);
<span class="hljs-keyword">const</span> expect = <span class="hljs-built_in">require</span>(<span class="hljs-string">"chai"</span>).expect;
<span class="hljs-keyword">const</span> MailBotsApp = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mailbots"</span>);
<span class="hljs-keyword">let</span> mailbot; <span class="hljs-comment">// re-instantiated before each test</span>

<span class="hljs-comment">// Utility function to send webhook to our app</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sendWebhook</span>(<span class="hljs-params">{ exportedApp, webhookJson }</span>) </span>{
  <span class="hljs-keyword">return</span> request(exportedApp)
    .post(<span class="hljs-string">"/webhooks"</span>)
    .set(<span class="hljs-string">"Accept"</span>, <span class="hljs-string">"application/json"</span>)
    .send(webhookJson);
}

describe(<span class="hljs-string">"integration tests"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  beforeEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    mailbot = <span class="hljs-keyword">new</span> MailBotsApp({ <span class="hljs-attr">clientId</span>: <span class="hljs-string">"foo"</span>, <span class="hljs-attr">clientSecret</span>: <span class="hljs-string">"bar"</span> });
  });

  it(<span class="hljs-string">"responds correctly to a webhook"</span>, <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">const</span> mailbot = <span class="hljs-keyword">new</span> MailBotsApp({ <span class="hljs-attr">clientId</span>: <span class="hljs-string">"foo"</span>, <span class="hljs-attr">clientSecret</span>: <span class="hljs-string">"bar"</span> });

    <span class="hljs-comment">// set up handlers</span>
    mailbot.onCommand(<span class="hljs-string">"memorize"</span>, bot =&gt; {
      bot.webhook.quickReply(<span class="hljs-string">"I dig email"</span>);
      bot.webhook.respond();
    });

    <span class="hljs-keyword">const</span> exportedApp = mailbot.exportApp();
    <span class="hljs-keyword">const</span> webhookJson = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./_fixtures/task.created.json"</span>); <span class="hljs-comment">// Copy request from Sandbox</span>
    <span class="hljs-keyword">let</span> { body } = <span class="hljs-keyword">await</span> sendWebhook({ exportedApp, webhookJson });

    <span class="hljs-comment">// Test our webhook response</span>
    expect(body.send_messages[<span class="hljs-number">0</span>].subject).to.equal(<span class="hljs-string">"I dig email"</span>);
  });
});</pre>
<h1>Installing</h1>
<p>The setup process on mailbots.com creates a pre-installed instance of your MailBot using <a href="https://glitch.com/">Glitch</a>.</p>
<p>For local development or production deployments:</p>
<p><strong>1. Install</strong></p>
<ul>
<li><code>mkdir my-bot</code></li>
<li><code>npm init -y</code></li>
<li><code>npm install mailbots</code></li>
<li><code>touch app.js</code></li>
</ul>
<p><strong>2. Add Setup Code</strong></p>
<pre class='hljs'><span class="hljs-keyword">const</span> MailBot = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mailbots"</span>);
<span class="hljs-keyword">const</span> mailbot = <span class="hljs-keyword">new</span> MailBot({
  <span class="hljs-attr">clientId</span>: <span class="hljs-string">"your_client_id"</span>,
  <span class="hljs-attr">clientSecret</span>: <span class="hljs-string">"your_secret"</span>,
  <span class="hljs-attr">mailbotUrl</span>: <span class="hljs-string">"http://your_bot_url"</span>
});
<span class="hljs-comment">// <span class="hljs-doctag">NOTE:</span> The recommended way to set up your MailBot is to set</span>
<span class="hljs-comment">// CLIENT_ID, CLIENT_SECRET and MAILBOT_URL in env and use dotenv</span>

mailbot.onCommand(<span class="hljs-string">"hello"</span>, bot =&gt; {
  bot.webhook.quickReply(<span class="hljs-string">"world"</span>);
  bot.webhook.respond();
});

mailbot.listen();</pre>
<ol start="3">
<li>
<p>Use <a href="https://ngrok.com/">ngrok</a> to set up a public-facing url that MailBots.com can reach.</p>
</li>
<li>
<p>Create a MailBot at mailbots.com. Click "Manual Setup" at the bottom and follow instructions from there.</p>
</li>
</ol>
<h1>Contributions</h1>
<p>Contributions are welcome in the form of PRs and / or Github tickets for issues, bugs, ideas and feature requests.
Please follow the <a href="https://github.com/mailbots/mailbots#use-of-mailbot-mailbot-mailbots-and-bots">MailBot naming conventions</a>.
We use ngrok to mock API requests, included in the test package here. This can be disabled to test against the live
API (see package.json).</p>

    
  </section>
</div>
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='intro'>
      intro
    </h3>
    
    
  </div>
  

  <p><a href="https://www.mailbots.com">MailBots</a> is a platform for creating bots, AIs and assistants that get things done right from your inbox. Read more at <a href="https://www.mailbots.com">mailbots.com</a>.</p>
<h1>Quick Start</h1>
<p>Go to mailbots.com and create a MailBot. The bot creation process sets up a working instance of this framework.</p>
<p>Next, let's tell our MailBot what to do when it receives an email:</p>
<pre class='hljs'><span class="hljs-keyword">var</span> MailBot = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mailbots"</span>);
<span class="hljs-keyword">var</span> mailbot = <span class="hljs-keyword">new</span> MailBot(); <span class="hljs-comment">// assuming .env is set</span>

<span class="hljs-comment">// When someone emails: say-hi@my-bot.eml.bot, respond "Hello Human!"</span>
mailbot.onCommand(<span class="hljs-string">"say-hi"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  bot.webhook.quickReply(<span class="hljs-string">"Hello Human!"</span>);
  bot.webhook.respond();
});

mailbot.listen();</pre>
<p><code>say-hi@my-bot.eml.bot</code> is an example of an "email command". Whatever is before the @ sign is a command to your bot to accomplish some task. <a href="https://docs.mailbots.com/reference#email-commands">Read more about email commands</a>.</p>
<h1>Docs</h1>
<p>Tip: Use our <a href="https://mailbots-app.mailbots.com">reference guide</a> to quickly look up helpers and method names.</p>
<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
<ul>
<li>
<p><a href="#how-mailbots-work">How MailBots Work</a></p>
<ul>
<li><a href="#tasks">Tasks</a></li>
<li><a href="#commands">Commands</a></li>
<li><a href="#triggering">Triggering</a></li>
<li><a href="#architecture">Architecture</a></li>
<li><a href="#handlers">Handlers</a></li>
<li><a href="#skills">Skills</a></li>
</ul>
</li>
<li>
<p><a href="#examples">Examples:</a></p>
<ul>
<li><a href="#hello-world">Hello World</a></li>
<li><a href="#set-a-reminder">Set a Reminder</a></li>
<li><a href="#handle-action-emails">Handle Action-Emails</a></li>
<li><a href="#install-a-skill">Install A Skill</a></li>
</ul>
</li>
<li>
<p><a href="#handler-reference">Handler Reference</a></p>
<ul>
<li><a href="#oncommand">onCommand</a></li>
<li><a href="#ontrigger">onTrigger</a></li>
<li><a href="#onaction">onAction</a></li>
<li><a href="#ontaskviewed">onTaskViewed</a></li>
<li><a href="#onevent">onEvent</a></li>
<li><a href="#onsettingsviewed">onSettingsViewed</a></li>
<li><a href="#beforesettingssaved">beforeSettingsSaved</a></li>
<li><a href="#on">on</a></li>
<li><a href="#handling-errors">Handling Errors</a></li>
</ul>
</li>
<li><a href="#the-bot-object">The "bot" Object</a></li>
<li>
<p><a href="#building-skills">Building Skills</a></p>
<ul>
<li><a href="#using-handlers">Using Handlers</a></li>
<li><a href="#the-one-bot-function">The "one-bot function"</a></li>
<li><a href="#handling-web-requests">Handling Web Requests</a></li>
<li><a href="#middleware">Middleware</a></li>
<li><a href="#namespacing-conventions">Namespacing Conventions</a></li>
</ul>
</li>
<li>
<p><a href="#installing-skills%C2%A0from-npm">Installing Skills¬†From npm</a></p>
<ul>
<li><a href="#skills-with-side-effects">Skills With Side-Effects</a></li>
</ul>
</li>
<li><a href="#welcoming-new-users">Welcoming New Users</a></li>
<li><a href="#testing">Testing</a></li>
<li><a href="#installing">Installing</a></li>
<li><a href="#contributions">Contributions</a></li>
</ul>
<!-- END doctoc generated TOC please keep comment here to allow auto update -->
<h1>How MailBots Work</h1>
<p>A MailBot's purpose is to help someone get something done quickly, efficiently and without leaving their inbox.</p>
<h2>Tasks</h2>
<p>A unit of work accomplished by a MailBot is called a "task". Tasks can scheduled, edited or "completed". Tasks are always associated with a command.</p>
<h2>Commands</h2>
<p>MailBots always work in the context of commands while accomplishing tasks. A command can be thought of as the instruction for how to complete a particular task, or the purpose of the task. Email Commands (shown above) are one way to issue commands. Creating a task with the API also requires a command.</p>
<h2>Triggering</h2>
<p>A task (that carries out a command) can be created then wait for the perfect moment to notify a user. Timliness is a core feature of of a MailBot.</p>
<h2>Architecture</h2>
<p>When events happen in the MailBots platform (ex: an email is received), your MailBot receives webhooks. Your MailBot then gets some useful bit of work done (ex: enters data into a CRM) and responds with JSON that tells the MailBots platform what to do next (ex: send an email, store data, set a reminder, etc). JSON in, JSON out.</p>
<p>This library simplifies much of the above architecture, allowing you to simply create handler functions for certain events.</p>
<p>The webhook request and response can be viewed via the <a href="https://app.mailbots.com/sandbox">MailBots Sandbox</a>.</p>
<h2>Handlers</h2>
<p>MailBots are composed of handlers ‚Äì functions that run when certain events occur. For example: <em>When the bot receives an email at this address, execute these actions</em></p>
<h2>Skills</h2>
<p>Handlers and other bot functionality can be packaged into "skills" ‚Äì high-level abilities that can shared between bots. Here are some example skills:</p>
<ul>
<li>Interact with a CRM</li>
<li>Parse natural language</li>
<li>Send a text message or Slack message</li>
<li>Render special UI elements</li>
</ul>
<p>You can publish, share and install new skills from npm.</p>
<h1>Examples:</h1>
<h2>Hello World</h2>
<p>Create an <a href="https://docs.mailbots.com/reference#email-commands">email command</a> that says hi.</p>
<pre class='hljs'><span class="hljs-keyword">var</span> MailBotsApp = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mailbots"</span>);
<span class="hljs-keyword">var</span> app = <span class="hljs-keyword">new</span> MailBotsApp();

mailbot.onCommand(<span class="hljs-string">"hi"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  bot.webhook.quickReply(<span class="hljs-string">"Hi back!"</span>);
  bot.webhook.respond();
});

mailbot.listen();</pre>
<h2>Set a Reminder</h2>
<p>The first handler creates the reminder. The second one handles the reminder when it becomes due.</p>
<pre class='hljs'>mailbot.onCommand(<span class="hljs-string">"hi"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// Schedule the task to trigger in 1 minute</span>
  bot.webhook.setTriggerTime(<span class="hljs-string">"1min"</span>);
  bot.webhook.respond();
});

<span class="hljs-comment">// When a task with "hi" command triggers, run this</span>
mailbot.onTrigger(<span class="hljs-string">"hi"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  bot.webhook.quickReply(<span class="hljs-string">"Hi 1 minute later!"</span>);
  bot.webhook.respond();
});</pre>
<h2>Handle Action-Emails</h2>
<p>MailBots can render quick-action buttons (mailto links that map to executable code) that let users get things done without leaving their inbox. Read more about <a href="https://docs.mailbots.com/reference#email-based-actions">action emails</a>.</p>
<pre class='hljs'><span class="hljs-comment">// This first handler renders an email¬†with an action-email button</span>
 mailbot.onCommand(<span class="hljs-string">"send-buttons"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
    bot.webhook.sendEmail({
      <span class="hljs-attr">to</span>: bot.get(<span class="hljs-string">'source.from'</span>)
      <span class="hljs-keyword">from</span>: <span class="hljs-string">"MyBot"</span>,
      <span class="hljs-attr">subject</span>: bot.get(<span class="hljs-string">'source.subject'</span>),
      <span class="hljs-attr">body</span>: [

        <span class="hljs-comment">// üëá An email-action</span>
        {
          <span class="hljs-attr">type</span>: <span class="hljs-string">"button"</span>,
          <span class="hljs-attr">behavior</span>: <span class="hljs-string">"action"</span>,
          <span class="hljs-attr">text</span>: <span class="hljs-string">"Press Me"</span>,
          <span class="hljs-attr">action</span>: <span class="hljs-string">'say.hi'</span>,
          <span class="hljs-attr">subject</span>: <span class="hljs-string">"Just hit 'send'"</span>,
        }
      ]
    });
    bot.webhook.respond();
  };

  <span class="hljs-comment">// This handler handles the email action</span>
  mailbot.onAction(<span class="hljs-string">'say.hi'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
    bot.webhook.quickReply(<span class="hljs-string">'hi'</span>);
    <span class="hljs-comment">// Lots of useful things can be done here. Completing a todo item, adding notes to a CRM, etc.</span>
    bot.webhook.respond();
  });

  mailbot.listen();</pre>
<h2>Install A Skill</h2>
<p>Let's install a skill to that extracts the email message from previously quoted emails and signatures.</p>
<pre class='hljs'><span class="hljs-keyword">var</span> mailbotsTalon = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mailbots-talon"</span>);
mailbot.onCommand(<span class="hljs-string">"hi"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-keyword">const</span> emailWithoutSignature = mailbotsTalon.getEmail(bot);
  bot.quickReply(
    <span class="hljs-string">"Here is the email without the signature:"</span> + emailWithoutSignature
  );
  bot.webhook.respond();
});</pre>
<h1>Handler Reference</h1>
<p>Note: The first matching event handler ends the request, even if subsequent handlers also match, except where otherwise noted.</p>
<h2>onCommand</h2>
<pre><code>mailbot.onCommand(command, handlerFn)
</code></pre>
<p>Handle when an <a href="https://docs.mailbots.com/reference">email command</a> is received. This also fires when a new task is created via the API (All tasks have a command to define their purpose or reason for existence.)</p>
<pre class='hljs'>mailbot.onCommand(<span class="hljs-string">"todo"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">//handle when a task is created with this command string</span>
});</pre>
<p>Regular expressions work with all handlers.</p>
<pre class='hljs'>mailbot.onCommand(<span class="hljs-regexp">/todo.*/</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">//Handle todo.me@my-ext.eml.bot, todo.you@my-ext.eml.bot, todo.everyone@my-ext.eml.bot</span>
});</pre>
<h2>onTrigger</h2>
<pre><code>mailbot.onTrigger(command, handlerFn)
</code></pre>
<p>Timeliness is a MailBot superpower. A user can schedule a task, then days, months or years later your bot can follow up at the exact right moment ‚Äì scheduled by the user, or by another event. Read more about <a href="https://docs.mailbots.com/reference#perfect-timing">triggering</a>.</p>
<p>Tasks with different commands may trigger differently. For example:</p>
<pre class='hljs'>mailbot.onTrigger(<span class="hljs-string">"todo.me"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// Assigned to myself, so only remind me</span>
});</pre>
<pre class='hljs'>mailbot.onTrigger(<span class="hljs-string">"todo.assign"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// Assigned to the person in the 'to' field, so remind them</span>
});</pre>
<pre class='hljs'>mailbot.onTrigger(<span class="hljs-string">"todo.crm"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// Query CRM API, populate email followup with contact data</span>
});</pre>
<h2>onAction</h2>
<pre><code>mailbot.onAction(action, handlerFn)
</code></pre>
<p>Handle when a user performs an action that relates to a task.</p>
<p>For example a user can send an <a href="https://docs.mailbots.com/reference#email-based-actions">action-email</a> to accomplish an action without leaving their inbox (postponing a reminder, completing a todo item, logging a call, etc).</p>
<pre class='hljs'>mailbot.onAction(<span class="hljs-string">"complete"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// Complete the related todo</span>
});</pre>
<p><strong>MailBot Conversations</strong></p>
<p>Set the reply-to address of a MailBot email to an action email to carry out a conversation with the user.</p>
<pre class='hljs'>mailbot.onAction(<span class="hljs-string">"assistant"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// Use luis-ai middlweare to dtermine intent</span>
  <span class="hljs-comment">// Store conversation state</span>
  <span class="hljs-comment">// send-email whose reply-to is also "assistant"</span>
});</pre>
<h2>onTaskViewed</h2>
<pre><code>mailbot.onTaskViewed(command, handlerFn)
</code></pre>
<p>Handle when a task is viewed in the MailBots Web UI, allowing a user to view and interact with a future MailBots email.</p>
<pre class='hljs'>mailbot.onTaskViewed(<span class="hljs-string">"todo.me"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// Show a preview of the future email</span>
});</pre>
<p>Different task commands may render differently. For example a task with command <code>todo.crm</code> may query and render current CRM data within the preview.</p>
<h2>onEvent</h2>
<pre><code>mailbot.onEvent(event, handlerFn)
</code></pre>
<p>Handle when the MailBot receives an inbound webhok from a 3rd party system about an external event. For example, a support ticket is created or a lead is added to a CRM.</p>
<p>Note: This action does not automatically create a MailBots Task. One can be created with <a href="https://www.npmjs.com/package/@mailbots/mailbots-sdk">mailbots-sdk</a></p>
<pre class='hljs'>mailbot.onEvent(<span class="hljs-string">"issue.created"</span>, <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// Handle event, for example, create a MailBots Task.</span>
  <span class="hljs-keyword">const</span> mailBotsClient = MailBotsClient.fromBot(bot);
  <span class="hljs-keyword">await</span> mailBotsClient.createTask({
    <span class="hljs-comment">// Pre-authenticated API client</span>
  });
  bot.webhook.respond({ <span class="hljs-attr">webhook</span>: { <span class="hljs-attr">status</span>: <span class="hljs-string">"success"</span> } });
});</pre>
<h2>onSettingsViewed</h2>
<pre><code>mailbot.onSettingsViewed(handlerFn)
</code></pre>
<p>Handle when a user views this MailBot's settings.</p>
<p>Bots can build custom settings pages. These are rendered when a user views bot settings on the MailBots.com admin UI.</p>
<p>See the <a href="https://mailbots-app.mailbots.com/#settingspage">settings page reference</a>.</p>
<p>The handler's only parameter is a callback function that responds with JSON to to render a settings form. The callback function is passed the <code>bot</code> object as usual.</p>
<p>Settings form JSON can be easily built using the <a href="https://mailbots-app.mailbots.com/#settingspage">settings helper functions</a>.</p>
<p>Unlike the other handlers, every instance of this handler is called. (ie, all settings pages from all settings handlers are rendered).</p>
<p>NOTE: Do not call <code>bot.webhook.respond()</code> at the end of this particular request. MailBots' internals take care of compiling the JSON and responding.</p>
<pre class='hljs'><span class="hljs-comment">// Render a settings field for the user to enter their first name</span>
mailbot.onSettingsViewed(<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-keyword">const</span> todoSettings = bot.webhook.settingsPage({
    <span class="hljs-attr">namespace</span>: <span class="hljs-string">"todo"</span>,
    <span class="hljs-attr">title</span>: <span class="hljs-string">"Todo Settings"</span>, <span class="hljs-comment">// Page title</span>
    menuTitle: <span class="hljs-string">"Todo"</span> <span class="hljs-comment">// Name of menu item</span>
  });
  todoSettings.input({ <span class="hljs-attr">name</span>: <span class="hljs-string">"first_name"</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">"First name"</span> });
  todoSettings.submitButton();

  <span class="hljs-comment">// Populate form values</span>
  todoSettings.populate(bot.get(<span class="hljs-string">"mailbot.stored_data.todo"</span>));
  <span class="hljs-comment">// Note bot.webhook.respond() is NOT called</span>
});</pre>
<p>URL parameters are passed through to the settings webhook. Use this to pass data into your settings when linking to it.</p>
<pre class='hljs'>mailbot.onSettingsViewed(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-keyword">const</span> settingsPage = bot.webhook.settingsPage({ <span class="hljs-attr">namespace</span>: <span class="hljs-string">"todo"</span> });

  <span class="hljs-keyword">if</span> (bot.get(<span class="hljs-string">"url_params.linkInstructions"</span>, <span class="hljs-literal">false</span>)) {
    settings.text(<span class="hljs-string">`# Instructions to link your account!`</span>);
  }
  <span class="hljs-comment">// Note that there is no submit button. It's just an informational page.</span>
});</pre>
<p>If you wish to use URL params in your <code>beforeSettingsSaved</code> handler (below), pass them via the <code>urlParams</code> key in the <code>submit</code> form element.</p>
<pre class='hljs'><span class="hljs-comment">// within a onSettingsViewed form as shown above</span>
settings.submitButton({
  <span class="hljs-attr">submitText</span>: <span class="hljs-string">"Save Notification Settings"</span>,
  <span class="hljs-attr">urlParams</span>: { <span class="hljs-attr">saveSettings</span>: <span class="hljs-number">1</span> }
  <span class="hljs-comment">// Tip: Pass through all URL current params, but use caution! (see note)</span>
  <span class="hljs-comment">// urlParams: {saveSettings: 1, ...bot.get("url_params", {})}</span>
});</pre>
<p>NOTE: URL parameters are an easy way to pass data into your bot settings, but <strong>keep this in mind while using URL params</strong>: Anyone can link a user to their settings page with <em>anything</em> in URL. Do not, for example, create a url like: <code>/settings?delete_everything=true</code> that deletes all their tasks. An unsuspecting user may arrive on their settings page from an external link, not see this in the URL and submit the form only find themselves without any data. <a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)">Read more</a>.</p>
<h2>beforeSettingsSaved</h2>
<pre><code>mailbot.beforeSettingsSaved(handlerFn)
</code></pre>
<p>Handle when the user saves their settings. Called before settings are actually saved.</p>
<p>Similar to the above <code>onSettingsViewed</code> handler, every instance of this handler is called when settings are saved.</p>
<p>Validate user data, perform API calls to keep other systems in sync. Return an error
to abort saving the settings.</p>
<pre class='hljs'>mailbot.beforeSettingsSaved(<span class="hljs-function"><span class="hljs-params">bot</span> =&gt;</span> {
  <span class="hljs-comment">// assuming the same "todo" namespace as shown in the above examples</span>
  <span class="hljs-keyword">const</span> data = bot.get(<span class="hljs-string">"settings.todo"</span>);

  <span class="hljs-comment">// handler is fired any times settings are saved, even if its not our form</span>
  <span class="hljs-keyword">if</span> (!data) <span class="hljs-keyword">return</span>;

  <span class="hljs-comment">// perform API calls, update external systems, etc. If something goes wrong...</span>
  <span class="hljs-keyword">if</span> (error) {
    <span class="hljs-comment">// abort the saving process</span>
    <span class="hljs-keyword">return</span> bot.webhook.respond({
      <span class="hljs-attr">webhook</span>: {
        <span class="hljs-attr">status</span>: <span class="hljs-string">"error"</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">"This is  a warning message"</span>
      }
    });
  }

  <span class="hljs-comment">// Othwise, it implicitly returns success, and the saving process continues</span>
});</pre>
<h2>on</h2>
<pre><code>mailbot.on(webhookEvent, handlerFn)
</code></pre>
<p>This is a generic handler for any webhook. It can be used to handle any inbound webhook ‚Äì¬†mainly ones that are not covered by the handlers above. (Of note: The handlers above are simply wrappers for this lower-level handler).</p>
<p>Example:</p>
<pre class='hljs'>mailbot.on(<span class="hljs-string">"mailbot.installed"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// Handle when a MailBot is installed</span>
  <span class="hljs-comment">// Create task with MailBots SDK</span>
  <span class="hljs-comment">// bot.webhook.respond();</span>
});</pre>
<p>The first paramater can be:</p>
<ul>
<li>A string that matches the webhook <code>type</code>. (ie. <a href="https://docs.mailbots.com/reference#mailbotinstalled"><code>mailbot.installed</code></a>)</li>
<li>A regular expression that matches on webhook <code>type</code></li>
<li>A function that takes the incoming webhook as the only parameter and returns a boolean value indicating whether or not that webhook should be handled by that function handler.</li>
</ul>
<p>The second parameter is the function handler that runs only if the matching condition (the first parameter) is met.</p>
<pre class='hljs'>mailbot.on(<span class="hljs-string">"mailbot.installed"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// Handle when a MailBot is installed</span>
  <span class="hljs-comment">// Create a task from mailbots sdk</span>
  <span class="hljs-comment">// bot.webhook.respond();</span>
});</pre>
<h2>Handling Errors</h2>
<p>Ideally, error conditions are handled within the normal application flow. If something unexpected happens you can set up a custom error handler for adding logs, alerting or providing error messaging to users.</p>
<p>If you want to send the user your own error email, use the <a href="https://mailbots-sdk-js.mailbots.com/#sendemaill">sendEmail</a> method from the MailBots SDK. (Not all webhook responses send emails).</p>
<pre class='hljs'><span class="hljs-comment">// define a custom error handler</span>
app.setErrorHandler(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error, bot</span>) </span>{
  <span class="hljs-comment">// myCustomLogger.log(error);</span>
  <span class="hljs-comment">// send email with mailbots sdk</span>
  <span class="hljs-comment">// send a custom error email to user</span>
  <span class="hljs-comment">// Respond with 5xx status code to send the generic MailBots error email to the user</span>
  <span class="hljs-comment">// bot.response.status(500);</span>

  bot.webhook.respond({
    <span class="hljs-attr">status</span>: <span class="hljs-string">"error"</span>,
    <span class="hljs-attr">message</span>: <span class="hljs-string">"A custom error message"</span> <span class="hljs-comment">// Shown to user if in the web UI.</span>
  }); <span class="hljs-comment">// A webhook response must be sent</span>
});</pre>
<h1>The "bot" Object</h1>
<p>The <code>bot</code> object passed to the handlers above contains useful helpers that make it easy to handle bot requests. See <a href="https://mailbots-app.mailbots.com/#webhookhelpers">webhook helpers reference docs</a>.</p>
<p><strong>Setting Data Works By Shallow Merging</strong>
Data is set by shallow merging. For example.</p>
<pre class='hljs'>bot.webhook.setTaskData(<span class="hljs-string">"my_namespace"</span>, { <span class="hljs-attr">name</span>: <span class="hljs-string">"Joe"</span> });
bot.webhook.setTaskData(<span class="hljs-string">"my_namespace"</span>, { <span class="hljs-attr">key</span>: <span class="hljs-string">"123"</span> });
<span class="hljs-comment">// task data is now</span>
<span class="hljs-built_in">console</span>.log(bot.webhook.responseJson);
<span class="hljs-comment">// {my_namespace: { name: "Joe", key: "123" }}</span></pre>
<pre class='hljs'>bot.webhook.setTaskData(<span class="hljs-string">"my_namespace"</span>, {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Joe"</span>,
  <span class="hljs-attr">data</span>: { <span class="hljs-attr">value</span>: <span class="hljs-string">"here"</span> } <span class="hljs-comment">// ‚ö†Ô∏è Overwritten (shallow merge)</span>
});
bot.webhook.setTaskData(<span class="hljs-string">"my_namespace"</span>, {
  <span class="hljs-attr">data</span>: { <span class="hljs-attr">value2</span>: <span class="hljs-string">"there"</span> }
});
<span class="hljs-comment">// task data is now</span>
<span class="hljs-built_in">console</span>.log(bot.webhook.responseJson);
<span class="hljs-comment">// {my_namespace: { data: { value2: "there" } }}</span></pre>
<h1>Building Skills</h1>
<p>"Skills" are sharable pieces of bot functionality. Skills can encapsulate everything they need (handlers, settings panels helper funcitons and UI elements) into a package that "just works" when installed. They are great for keeping your code organized and for sharing functionality with others.</p>
<p>A skill can share functionality in several ways:</p>
<h2>Using Handlers</h2>
<p>We could better organize our handlers in the above examples by grouping them into different files. For example:</p>
<pre class='hljs'><span class="hljs-comment">// my-new-reminder-skill.js</span>
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">mailbot</span>) </span>{
  <span class="hljs-comment">// Handlers can go here</span>
  <span class="hljs-comment">// mailbot.onCommand...</span>
};</pre>
<p>It can be loaded like this:</p>
<pre class='hljs'><span class="hljs-comment">// In top-level app.js</span>
<span class="hljs-built_in">require</span>(<span class="hljs-string">"./my-new-skill"</span>)(mailbot);</pre>
<p>Once loaded, all handlers within the file become active.</p>
<p>A directory of skill files (like the one above) can be loaded using the <code>loadSkill</code> helper:</p>
<pre class='hljs'><span class="hljs-comment">// Load all skill files in a directory</span>
mailbot.loadSkill(__dirname + <span class="hljs-string">"/my/skill/"</span>);</pre>
<p><code>loadSkill</code> only looks for skill files in the top-level directory. This allows a skill to hide¬†its implementation details in subdirectories.</p>
<p>A config object can optionally be passed.</p>
<pre class='hljs'><span class="hljs-comment">// app.js</span>
mailbot.loadSkill(__dirname + <span class="hljs-string">"/my/skills/"</span>, config);</pre>
<pre class='hljs'><span class="hljs-comment">// skill-file.js</span>
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">mailbot, config</span>) </span>{
  <span class="hljs-comment">// All of your handlers can go here</span>
};</pre>
<p>Grouping your handlers into skills is a great way to keep your project organized. The down-side is that the skill owns each request from beginning to end ‚Äì not very flexible.</p>
<p>The next section covers a more granular and composable technique for sharing functionality across multiple handlers or multiple MailBots.</p>
<h2>The "one-bot function"</h2>
<p>A "one-bot function" is a function that takes a single <code>bot</code> object (an instance of BotRequest) which, itself, contains the request / response state and utilities to alter the request. It is one instance of a bot request, hence, a one-bot function.</p>
<p>One-bot functions are called within handlers, allowing for a top-level handler to compose multiple one-bot functions to get something done.</p>
<pre class='hljs'><span class="hljs-comment">// sayHi.js</span>
<span class="hljs-comment">// A simple "one-bot function"</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sayHi</span>(<span class="hljs-params">bot</span>) </span>{
  bot.webhook.quickReply(<span class="hljs-string">"hi"</span>);
}
<span class="hljs-built_in">module</span>.exports = sayHi;</pre>
<pre class='hljs'><span class="hljs-comment">// in main app.js</span>
<span class="hljs-keyword">const</span> sayHi = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./sayHi.js"</span>);
<span class="hljs-comment">//...</span>
mailbots.onCommand(<span class="hljs-string">"hi"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  sayHi(bot);
  bot.webhook.respond();
});</pre>
<p>You can, of course, use both the one-bot function and a handler within one skill:</p>
<pre class='hljs'><span class="hljs-comment">// my-reminder-skill.js</span>
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">mailbot</span>) </span>{
  <span class="hljs-comment">// Handles all triggering for this MailBot (/.*/ matches anything)</span>
  mailbot.onTrigger(<span class="hljs-regexp">/.*/</span>, funciton(bot) {
    <span class="hljs-comment">// Do some useful things, send emails,etc.</span>
    bot.webhook.respond();
  });

  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">remindTomorrow</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
        bot.webhook.setTriggerTime(<span class="hljs-string">"tomorrow"</span>);
    }
  };
};</pre>
<pre class='hljs'><span class="hljs-comment">// Use the reminder skill</span>
<span class="hljs-keyword">const</span> { remindTomorrow } = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./my-reminder-skill"</span>)(mailbot);

mailbot.onCommand(<span class="hljs-string">"whatever-custom-command"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// Set a reminder. When due, the skill automatically handles it.</span>
  remindTomorrow(bot);
  bot.webhook.respond();
});</pre>
<h3>Sharing UI Elements</h3>
<p>Skills can use one-bot functions to share <a href="https://docs.mailbots.com/docs/email-ui-reference">UI elements</a>.</p>
<p>By convention, UI functions that output UI start with <code>render</code>. For example, <code>renderMemorizationControls</code>.</p>
<pre class='hljs'>  <span class="hljs-keyword">var</span> memorizeSkill = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mailbots-memorize"</span>)(mailbot);
  mailbot.onCommand(<span class="hljs-string">"remember"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
    bot.webhook.sendEmail({
      <span class="hljs-attr">to</span>: <span class="hljs-string">"you@email.com"</span>
      <span class="hljs-keyword">from</span>: <span class="hljs-string">"MailBots"</span>,
      <span class="hljs-attr">subject</span>: <span class="hljs-string">"Email Subject"</span>
      body: [
        {
          <span class="hljs-attr">type</span>: <span class="hljs-string">'title'</span>,
          <span class="hljs-attr">text</span>: <span class="hljs-string">'A Title'</span>
        },

        <span class="hljs-comment">// Render JSON UI</span>
        memorizeSkill.renderMemorizationControls(bot)
      ]
    })
    bot.webhook.respond();
  }</pre>
<h2>Handling Web Requests</h2>
<p>The <code>mailbots</code> framework relies on Express.js for many of its internals. Your skill can access the internal Express <code>app</code> object at <code>mailbot.app</code>, allowing your skill to do anything that can be done with Express: authenticate other services, interact with APIs, respond to webhooks and render web pages.</p>
<p>Just like in <a href="https://expressjs.com/en/guide/routing.html">handling routes in Express</a>:</p>
<pre class='hljs'>mailbot.app.get(<span class="hljs-string">"/hi"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>{
  res.send(<span class="hljs-string">"&lt;h1&gt;Hi http request!&lt;/h1&gt;"</span>);
});</pre>
<h2>Middleware</h2>
<p><a href="https://expressjs.com/en/guide/writing-middleware.html">Middlware</a> can be exported and "used" by other skills. This is useful for implementing common functionality across multiple handlers.</p>
<pre class='hljs'><span class="hljs-comment">// Export middleware to log everything</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logEverythingMiddleware</span>(<span class="hljs-params">req, res, next</span>) </span>{
  <span class="hljs-keyword">const</span> bot = res.locals.bot; <span class="hljs-comment">// bot lives here</span>
  <span class="hljs-keyword">const</span> emailSubject = bot.get(<span class="hljs-string">"source.subject"</span>);
  <span class="hljs-built_in">require</span>(<span class="hljs-string">"my-great-logger"</span>).log(<span class="hljs-string">`Got an email about <span class="hljs-subst">${emailSubject}</span>`</span>);
  next(); <span class="hljs-comment">// &lt;-- Don't forget this!</span>
}
<span class="hljs-built_in">module</span>.exports = logEverythingMiddleware;
};</pre>
<pre class='hljs'><span class="hljs-comment">// Using our middleware</span>
<span class="hljs-keyword">const</span> logEverythingMiddleware = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./log-everything"</span>);

<span class="hljs-comment">// Apply to all subsequent handlers</span>
<span class="hljs-comment">// Note: It does not apply to earlier handlers</span>
mailbot.app.use(logEverythingMiddleware);

mailbot.onCommand(<span class="hljs-string">"command-one"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// everything is logged</span>
});
mailbot.onCommand(<span class="hljs-string">"command-two"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// everything is logged</span>
});
mailbot.onCommand(<span class="hljs-string">"command-three"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  <span class="hljs-comment">// everything is logged</span>
});</pre>
<h2>Namespacing Conventions</h2>
<p>To prevent conflicts and facilitate debugging, it is helpful to follow these conventions. For examples below, our skill is <code>skill-name</code>.</p>
<ul>
<li>
<p>The module¬†name</p>
<pre><code># Example module name
npm install mailbots-skill-name
</code></pre>
</li>
<li>
<p>Store data against the task or bot in a subject with key of the skill name using underscores instead of dashes.</p>
<pre class='hljs'>(task.stored_data = { "skill_name": { "key": "val" } })</pre>
</li>
<li>
<p>Preface event names and actions with the skill name or an abbreviation (accounting for <a href="http://www.rfc-editor.org/errata/eid1690">character limitations</a>)</p>
<pre class='hljs'>mailbots.onAction(<span class="hljs-string">"sn.do-action"</span>, bot =&gt; {});</pre>
<h3>Use of "MailBot", "mailbot", "MailBots" and "bots"</h3>
<p>For clarity and to reduce ambiguity, follow these conventions:</p>
<ul>
<li>User-Facing: The name of the platform (and company) is "MailBots". Always studly-cased. Always plural.</li>
<li>User-Facing: One email-based bot is a "MailBot". Always studly-cased.</li>
<li>Code: <code>mailbot</code> (all lowercased) is an acceptable variable name, but...</li>
<li>Code: When the first "M" is capitalized, always capitalize the second. Ex: <code>createMailBot()</code>. <code>Mailbot</code> (lowercase "b") never exists.</li>
<li>Code: <code>bot</code> is only used for the bot helper object passed to handler functions.</li>
</ul>
</li>
</ul>
<h1>Installing Skills¬†From npm</h1>
<p>Skills can be installed from npm.</p>
<p>Here we will use <code>mailbots-memorize</code>, a skill that creates reminders for any <a href="https://docs.mailbots.com/reference">task</a> using <a href="https://www.wikiwand.com/en/Spaced_repetition">spaced repetition</a>, a memorization technique that increases the time between reminders as more reminders are sent.</p>
<p>In your cli, run:</p>
<p><code>npm install --save mailbots-memorize</code></p>
<p>In our app.js file we will create a handler that uses our newly installed skill.</p>
<pre class='hljs'><span class="hljs-comment">// In main app.js file</span>
<span class="hljs-keyword">var</span> memorizeSkill = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mailbots-memorize"</span>)(mailbot);

mailbot.onCommand(<span class="hljs-string">"remember"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  memorizeSkill.memorizeTask(bot); <span class="hljs-comment">//  ‚¨Ö Tell bot to memorize your task</span>
  bot.webhook.quickResponse(<span class="hljs-string">"Memorizing!"</span>);
  bot.webhook.respond();
});

<span class="hljs-comment">// Called each time the reminder is triggered</span>
mailbot.onTrigger(<span class="hljs-string">"remember"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  memorizeSkill.memorizeTask(bot); <span class="hljs-comment">// ‚¨Ö Invoke skill to continue memorizing</span>
  bot.webhook.quickResponse(<span class="hljs-string">"An email with decreasing frequency"</span>);
  bot.webhook.respond();
});</pre>
<h2>Skills With Side-Effects</h2>
<p>Skills that accept the <code>mailbots</code> object may automatically alter requests, reply to webhooks or take other automatic action behind the scenes.</p>
<pre class='hljs'><span class="hljs-comment">// May automatically handle requets (ex, render settings pages, send emails)</span>
<span class="hljs-keyword">var</span> handleEverything = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mailbots-handle-everything"</span>);
handleEverything(mailbot);
<span class="hljs-comment">// or</span>
<span class="hljs-built_in">require</span>(<span class="hljs-string">"handleEverything"</span>)(mailbot);</pre>
<p>Skills that are not passed the <code>mailbot</code> object will export components (middleware, one-bot functions, etc) for you to explicitly use in your handlers.</p>
<pre class='hljs'><span class="hljs-comment">// These types of skills offer components to your handlers</span>
<span class="hljs-keyword">var</span> {
  someMiddleware,
  renderSomething
} = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mailbots-provide-components"</span>);

mailbots.app.use(someMiddleware);

mailbots.onCommand(<span class="hljs-string">"foo"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
  doSomething(bot);
});</pre>
<p>Skills will, themselves, document how they are used. Different approaches are right for different circumstances.</p>
<h1>Welcoming New Users</h1>
<p>When a new user installs your MailBot, they are directed to a settings page with the <code>welcome</code> namespace. Render a custom welcome message for your user by creating a settings page that targets this namespace.</p>
<pre class='hljs'>mailbot.onSettingsViewed(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>)  </span>{
    <span class="hljs-keyword">const</span> welcomeSettings = bot.webhook.settingsPage({
      <span class="hljs-attr">namespace</span>: <span class="hljs-string">"welcome"</span>, <span class="hljs-comment">// MailBots sends new users to this namespace automatically</span>
      menuTitle: <span class="hljs-string">"Welcome"</span>
    });

    welcomeSettings.text(<span class="hljs-string">`
# Welcome To My MailBot
_Markdown_ works here.`</span>);
)}</pre>
<p>Note: While in dev_mode, the MailBot owner is instead redirected to the sandbox.</p>
<p>Your bot receives the <code>mailbot.installed</code> webhook which can be used to schedule a series of welcome emails to the user.</p>
<h1>Testing</h1>
<p>Export a testable instance of your MailBot by calling <code>mailbot.exportApp()</code> instead of calling <code>mailbot.listen()</code>. Below is an example of testing the exported app with <a href="https://www.npmjs.com/package/supertest">Supertest</a>.</p>
<p>For a sample request (the <code>./_fixtures/task.created.json</code> file below), fire a request and go to the sandbox. Click the "copy" icon that appears when you over over the the top-level key the request JSON.</p>
<p>Note: Set <code>NODE_ENV</code> to <code>testing</code> to disable webhook validation.</p>
<pre class='hljs'><span class="hljs-keyword">const</span> request = <span class="hljs-built_in">require</span>(<span class="hljs-string">"supertest"</span>);
<span class="hljs-keyword">const</span> mocha = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mocha"</span>);
<span class="hljs-keyword">const</span> expect = <span class="hljs-built_in">require</span>(<span class="hljs-string">"chai"</span>).expect;
<span class="hljs-keyword">const</span> MailBotsApp = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mailbots"</span>);
<span class="hljs-keyword">let</span> mailbot; <span class="hljs-comment">// re-instantiated before each test</span>

<span class="hljs-comment">// Utility function to send webhook to our app</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sendWebhook</span>(<span class="hljs-params">{ exportedApp, webhookJson }</span>) </span>{
  <span class="hljs-keyword">return</span> request(exportedApp)
    .post(<span class="hljs-string">"/webhooks"</span>)
    .set(<span class="hljs-string">"Accept"</span>, <span class="hljs-string">"application/json"</span>)
    .send(webhookJson);
}

describe(<span class="hljs-string">"integration tests"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  beforeEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    mailbot = <span class="hljs-keyword">new</span> MailBotsApp({ <span class="hljs-attr">clientId</span>: <span class="hljs-string">"foo"</span>, <span class="hljs-attr">clientSecret</span>: <span class="hljs-string">"bar"</span> });
  });

  it(<span class="hljs-string">"responds correctly to a webhook"</span>, <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">const</span> mailbot = <span class="hljs-keyword">new</span> MailBotsApp({ <span class="hljs-attr">clientId</span>: <span class="hljs-string">"foo"</span>, <span class="hljs-attr">clientSecret</span>: <span class="hljs-string">"bar"</span> });

    <span class="hljs-comment">// set up handlers</span>
    mailbot.onCommand(<span class="hljs-string">"memorize"</span>, bot =&gt; {
      bot.webhook.quickReply(<span class="hljs-string">"I dig email"</span>);
      bot.webhook.respond();
    });

    <span class="hljs-keyword">const</span> exportedApp = mailbot.exportApp();
    <span class="hljs-keyword">const</span> webhookJson = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./_fixtures/task.created.json"</span>); <span class="hljs-comment">// Copy request from Sandbox</span>
    <span class="hljs-keyword">let</span> { body } = <span class="hljs-keyword">await</span> sendWebhook({ exportedApp, webhookJson });

    <span class="hljs-comment">// Test our webhook response</span>
    expect(body.send_messages[<span class="hljs-number">0</span>].subject).to.equal(<span class="hljs-string">"I dig email"</span>);
  });
});</pre>
<h1>Installing</h1>
<p>The setup process on mailbots.com creates a pre-installed instance of your MailBot using <a href="https://glitch.com/">Glitch</a>.</p>
<p>For local development or production deployments:</p>
<p><strong>1. Install</strong></p>
<ul>
<li><code>mkdir my-bot</code></li>
<li><code>npm init -y</code></li>
<li><code>npm install mailbots</code></li>
<li><code>touch app.js</code></li>
</ul>
<p><strong>2. Add Setup Code</strong></p>
<pre class='hljs'><span class="hljs-keyword">const</span> MailBot = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mailbots"</span>);
<span class="hljs-keyword">const</span> mailbot = <span class="hljs-keyword">new</span> MailBot({
  <span class="hljs-attr">clientId</span>: <span class="hljs-string">"your_client_id"</span>,
  <span class="hljs-attr">clientSecret</span>: <span class="hljs-string">"your_secret"</span>,
  <span class="hljs-attr">mailbotUrl</span>: <span class="hljs-string">"http://your_bot_url"</span>
});
<span class="hljs-comment">// <span class="hljs-doctag">NOTE:</span> The recommended way to set up your MailBot is to set</span>
<span class="hljs-comment">// CLIENT_ID, CLIENT_SECRET and MAILBOT_URL in env and use dotenv</span>

mailbot.onCommand(<span class="hljs-string">"hello"</span>, bot =&gt; {
  bot.webhook.quickReply(<span class="hljs-string">"world"</span>);
  bot.webhook.respond();
});

mailbot.listen();</pre>
<ol start="3">
<li>
<p>Use <a href="https://ngrok.com/">ngrok</a> to set up a public-facing url that MailBots.com can reach.</p>
</li>
<li>
<p>Create a MailBot at mailbots.com. Click "Manual Setup" at the bottom and follow instructions from there.</p>
</li>
</ol>
<h1>Contributions</h1>
<p>Contributions are welcome in the form of PRs and / or Github tickets for issues, bugs, ideas and feature requests.
Please follow the <a href="https://github.com/mailbots/mailbots#use-of-mailbot-mailbot-mailbots-and-bots">MailBot naming conventions</a>.
We use ngrok to mock API requests, included in the test package here. This can be disabled to test against the live
API (see package.json).</p>

 
   
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  
</section>

        
          
            <div class='keyline-top-not py2'>
  <section class='py2 clearfix'>

    <h2 id='bot' class='mt0'>
      bot
    </h2>

    
      <p>"Bot" is the helpful object that are given to event handlers. It contains information about the
request and lots helpful methods to complete the request.</p>
<p>Bots have utilities to handle webhooks <strong>WebHookHelpers</strong></p>
<pre class='hljs'>mailbot.onCommand(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{ <span class="hljs-comment">// &lt;-- This is the "bot"</span>
  bot.webhook.quickReply(<span class="hljs-string">"hi"</span>);
  bot.webhook.respond();
});</pre>
<p>One of the webhook helpers lets you create a settings form. This is its own class: <strong>SettingsPage</strong></p>
<pre class='hljs'>  <span class="hljs-keyword">const</span> mySettingsPage = bot.webhook.settingsPage({
  <span class="hljs-attr">namespace</span>: <span class="hljs-string">"todo"</span>,
  <span class="hljs-attr">title</span>: <span class="hljs-string">"ToDo Settings"</span>,
  <span class="hljs-attr">menuTitle</span>: <span class="hljs-string">"To Do"</span>
  });</pre>

    
  </section>
</div>
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='bot'>
      bot
    </h3>
    
    
  </div>
  

  <p>"Bot" is the helpful object that are given to event handlers. It contains information about the
request and lots helpful methods to complete the request.</p>
<p>Bots have utilities to handle webhooks <strong>WebHookHelpers</strong></p>
<pre class='hljs'>mailbot.onCommand(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{ <span class="hljs-comment">// &lt;-- This is the "bot"</span>
  bot.webhook.quickReply(<span class="hljs-string">"hi"</span>);
  bot.webhook.respond();
});</pre>
<p>One of the webhook helpers lets you create a settings form. This is its own class: <strong>SettingsPage</strong></p>
<pre class='hljs'>  <span class="hljs-keyword">const</span> mySettingsPage = bot.webhook.settingsPage({
  <span class="hljs-attr">namespace</span>: <span class="hljs-string">"todo"</span>,
  <span class="hljs-attr">title</span>: <span class="hljs-string">"ToDo Settings"</span>,
  <span class="hljs-attr">menuTitle</span>: <span class="hljs-string">"To Do"</span>
  });</pre>

 
   
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  
</section>

        
          
            <div class='keyline-top-not py2'>
  <section class='py2 clearfix'>

    <h2 id='mailbots' class='mt0'>
      mailbots
    </h2>

    
      <p>A MailBot is an instance of the <strong>MailBots</strong> class. This class exposes handlers
that are used to respond to specific events. (See readme.md for more). </p>
<pre class='hljs'>  <span class="hljs-keyword">var</span> MailBots = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mailbots"</span>);
  <span class="hljs-keyword">var</span> mailbot = <span class="hljs-keyword">new</span> MailBots({
    <span class="hljs-attr">clientId</span>: <span class="hljs-string">"foo"</span>,
    <span class="hljs-attr">clientSecret</span>: <span class="hljs-string">"bar"</span>
  });

  mailbot.onCommand(<span class="hljs-string">"hi"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
    bot.webhook.quickReply(<span class="hljs-string">"Hi back!"</span>);
    bot.webhook.respond();
  });

  mailbot.listen();</pre>

    
  </section>
</div>
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='mailbots'>
      mailbots
    </h3>
    
    
  </div>
  

  <p>A MailBot is an instance of the <strong>MailBots</strong> class. This class exposes handlers
that are used to respond to specific events. (See readme.md for more). </p>
<pre class='hljs'>  <span class="hljs-keyword">var</span> MailBots = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mailbots"</span>);
  <span class="hljs-keyword">var</span> mailbot = <span class="hljs-keyword">new</span> MailBots({
    <span class="hljs-attr">clientId</span>: <span class="hljs-string">"foo"</span>,
    <span class="hljs-attr">clientSecret</span>: <span class="hljs-string">"bar"</span>
  });

  mailbot.onCommand(<span class="hljs-string">"hi"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
    bot.webhook.quickReply(<span class="hljs-string">"Hi back!"</span>);
    bot.webhook.respond();
  });

  mailbot.listen();</pre>

 
   
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='mailbots'>
      MailBots
    </h3>
    
    
  </div>
  

  <p>Create a new MailBot</p>
<p>Optionally instantiate with config. Pass any key shown in config.js.</p>

 
  
    <div class='pre p1 fill-light mt0'>new MailBots(instanceConfig: any, config: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>instanceConfig</span> <code class='quiet'>(any)</code>
	    
          </div>
          
        </div>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>config</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>)</code>
	    
          </div>
          
        </div>
      
    </div>
  

  

  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Instance Members</div>
    <div class="clearfix">
  
    <div class='border-bottom' id='mailbotslisten'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>‚ñ∏</a>
            <span class='code strong strong truncate'>listen()</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Loads final skills and start http server.
Anything posted to /webhooks route is automatically handled.
Other routes must be created as usual with the Express App object.
For example: mailbots.app.get("my-route/", (req, res) => {});</p>

 
  
    <div class='pre p1 fill-light mt0'>listen()</div>
   
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='mailbotsexportapp'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>‚ñ∏</a>
            <span class='code strong strong truncate'>exportApp()</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Export app for automated testing</p>

 
  
    <div class='pre p1 fill-light mt0'>exportApp()</div>
   
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='mailbotsloadskill'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>‚ñ∏</a>
            <span class='code strong strong truncate'>loadSkill(skill, config, skillPath)</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Load MailBots skills from a directory, non-recursively.
This can be called more than once to load skills in order. Skills loaded
this method are preceeded by loadFirstCoreSkills, succeeded by loadLastCoreSkills.
This can also receive a path to a file.</p>

 
  
    <div class='pre p1 fill-light mt0'>loadSkill(skill: any, config: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>, skillPath: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>skill</span> <code class='quiet'>(any)</code>
	    
          </div>
          
        </div>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>config</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>)</code>
	    optional skill configuration object

          </div>
          
        </div>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>skillPath</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>)</code>
	    path to skills directory

          </div>
          
        </div>
      
    </div>
  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='mailbotson'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>‚ñ∏</a>
            <span class='code strong strong truncate'>on(triggerCondition, cb, opts, event)</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Add handler for a given webhook event. Executes only the first handler
for a matching event. The first parameter can be either a string
(the named webhook event) or a function that is passed the webhook and
returns true or false to indicate if the handler should be run.
Example: controller.on('task.created', (bot, req, res) => { });
Example: controller.on((webhook) => webhook.event === 'task.created', cb)</p>

 
  
    <div class='pre p1 fill-light mt0'>on(triggerCondition: any, cb: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function">function</a>, opts: any, event: (<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a> | <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function">function</a>))</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>triggerCondition</span> <code class='quiet'>(any)</code>
	    
          </div>
          
        </div>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>cb</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function">function</a>)</code>
	    Handler function

          </div>
          
        </div>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>opts</span> <code class='quiet'>(any)</code>
	    
          </div>
          
        </div>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>event</span> <code class='quiet'>((<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a> | <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function">function</a>))</code>
	    A webhook event string (ex: task.created). Or
a function receives the webhook as a param, which returns a boolean value.

          </div>
          
        </div>
      
    </div>
  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='mailbotsoncommand'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>‚ñ∏</a>
            <span class='code strong strong truncate'>onCommand(commandSearch, cb)</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Captures only 'task.created' events where the command string matches</p>

 
  
    <div class='pre p1 fill-light mt0'>onCommand(commandSearch: (<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a> | RexExp), cb: any)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>commandSearch</span> <code class='quiet'>((<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a> | RexExp))</code>
	    
          </div>
          
        </div>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>cb</span> <code class='quiet'>(any)</code>
	    
          </div>
          
        </div>
      
    </div>
  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='mailbotsontrigger'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>‚ñ∏</a>
            <span class='code strong strong truncate'>onTrigger(commandSearch, cb)</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Captures only 'task.triggered' events where the command string matches</p>

 
  
    <div class='pre p1 fill-light mt0'>onTrigger(commandSearch: (<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a> | RexExp), cb: any)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>commandSearch</span> <code class='quiet'>((<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a> | RexExp))</code>
	    
          </div>
          
        </div>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>cb</span> <code class='quiet'>(any)</code>
	    
          </div>
          
        </div>
      
    </div>
  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='mailbotsonevent'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>‚ñ∏</a>
            <span class='code strong strong truncate'>onEvent(eventSearch, cb)</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Captures only 'mailbot.event_received' events
Note: This "Event" refers to the 3rd party webhooks
that are posted to the MailBot.</p>

 
  
    <div class='pre p1 fill-light mt0'>onEvent(eventSearch: (<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a> | RexExp), cb: any)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>eventSearch</span> <code class='quiet'>((<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a> | RexExp))</code>
	    
          </div>
          
        </div>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>cb</span> <code class='quiet'>(any)</code>
	    
          </div>
          
        </div>
      
    </div>
  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='mailbotsonaction'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>‚ñ∏</a>
            <span class='code strong strong truncate'>onAction(actionSearch, cb)</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Captures only 'task.action_received' events where the action string matches</p>

 
  
    <div class='pre p1 fill-light mt0'>onAction(actionSearch: (<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a> | <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/RegExp">RegExp</a>), cb: any)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>actionSearch</span> <code class='quiet'>((<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a> | <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/RegExp">RegExp</a>))</code>
	    
          </div>
          
        </div>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>cb</span> <code class='quiet'>(any)</code>
	    
          </div>
          
        </div>
      
    </div>
  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='mailbotsontaskviewed'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>‚ñ∏</a>
            <span class='code strong strong truncate'>onTaskViewed(commandSearch, cb)</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Captures only 'task.viewed' events where the command string matches</p>

 
  
    <div class='pre p1 fill-light mt0'>onTaskViewed(commandSearch: (<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a> | RexExp), cb: any)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>commandSearch</span> <code class='quiet'>((<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a> | RexExp))</code>
	    
          </div>
          
        </div>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>cb</span> <code class='quiet'>(any)</code>
	    
          </div>
          
        </div>
      
    </div>
  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='mailbotsonsettingsviewed'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>‚ñ∏</a>
            <span class='code strong strong truncate'>onSettingsViewed(cb)</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Handle webhook that fires when user is viewing MailBot.
ALL onSettingsViewed handlers fire when this webhook arrives. Each
handler can add and read data to and from its own namespace.</p>

 
  
    <div class='pre p1 fill-light mt0'>onSettingsViewed(cb: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function">function</a>)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>cb</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function">function</a>)</code>
	    Callback function that receives the bot object

          </div>
          
        </div>
      
    </div>
  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
    <div class='border-bottom' id='mailbotsbeforesettingssaved'>
      <div class="clearfix small pointer toggle-sibling">
        <div class="py1 contain">
            <a class='icon pin-right py1 dark-link caret-right'>‚ñ∏</a>
            <span class='code strong strong truncate'>beforeSettingsSaved(cb)</span>
        </div>
      </div>
      <div class="clearfix display-none toggle-target">
        <section class='p2 mb2 clearfix bg-white minishadow'>

  

  <p>Handle webhook that fires after a user hits "save" on their MailBot settings.
Newly saved settings arrive at the top-level settings object.
Existing settings are still in mailbot.stored_data.
Return webhook { status: "fail", message: "" } to abort the saving process.
Return extenesion and user data to update to save data as with other webhooks.
ALL beforeSettingsSaved handlers fire.</p>

 
  
    <div class='pre p1 fill-light mt0'>beforeSettingsSaved(cb: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function">function</a>)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>cb</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function">function</a>)</code>
	    Callback function that receives the bot object

          </div>
          
        </div>
      
    </div>
  

  

  

  

  

  

  

  
</section>

      </div>
    </div>
  
</div>

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='botwebhook'>
      bot.webhook
    </h3>
    
    
  </div>
  

  <p>The 'bot' object passed into the handlers comes with a number
of helpers to handle the request.</p>
<p>NOTE: This class is automatically instantiated with an instance
of BotRequest and made available under bot.webhook.</p>

 
  
    <div class='pre p1 fill-light mt0'>bot.webhook</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>botRequest</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>)</code>
	    An instnace of BotRequest

          </div>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>bot.webhook.getMailBotData(<span class="hljs-string">'memorize.settings'</span>);</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='get'>
      get
    </h3>
    
    
  </div>
  

  <p>Get the current value of a key.
If a value has already been been set
on the responseJson object, it return that value,
otherwise it returns the value in the request object.</p>

 
  
    <div class='pre p1 fill-light mt0'>get(key: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>, defaultValue: mixed)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>key</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>)</code>
	    JSON path to key

          </div>
          
        </div>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>defaultValue</span> <code class='quiet'>(mixed)</code>
	    Default if key is falsy

          </div>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>bot.webhook.get(<span class="hljs-string">'source.from'</span>); <span class="hljs-comment">// sender's email address</span></pre>
    
      
      <pre class='p1 overflow-auto round fill-light'>bot.get(<span class="hljs-string">'source.from'</span>); <span class="hljs-comment">// this method is also aliased directly on bot</span></pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='set'>
      set
    </h3>
    
    
  </div>
  

  <p>Set attributes on the this.responseJson object. If existing value and
new value are both objects (not Arrays) they are shallow-merged.
If new or old data are not objects, the value of the key is replaced
entirely.</p>

 
  
    <div class='pre p1 fill-light mt0'>set(key: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>, value: any, merge: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a>)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>key</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>)</code>
	    JSON Path to object within responseJson object

          </div>
          
        </div>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>value</span> <code class='quiet'>(any)</code>
	    Value

          </div>
          
        </div>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>merge</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a>)</code>
	    Objets are shallow-merged by default. Set this to
false to force the replacement of an object.

          </div>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>bot.set(<span class="hljs-string">'task.reference_email.subject'</span>, <span class="hljs-string">"New Subject!"</span>);</pre>
    
      
      <pre class='p1 overflow-auto round fill-light'>bot.set(<span class="hljs-string">'task.reference_email'</span>, { <span class="hljs-attr">subject</span>: <span class="hljs-string">"New Subject!"</span>}); <span class="hljs-comment">// Same effect as above</span></pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='gettaskdata'>
      getTaskData
    </h3>
    
    
  </div>
  

  <p>Get data for current task</p>

 
  
    <div class='pre p1 fill-light mt0'>getTaskData(key: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>, defaultValue: any)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>key</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>)</code>
	    JSON Path to key within task.private_data

          </div>
          
        </div>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>defaultValue</span> <code class='quiet'>(any)</code>
	    If there is no key, return this

          </div>
          
        </div>
      
    </div>
  

  

  

  

  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='settaskdata'>
      setTaskData
    </h3>
    
    
  </div>
  

  <p>Set data for current task
Takes either an object or a lodash _.set path as the first param,
optionally a value as the second parameter. Objects are shallow-merged
if new and old data are objects. (Arrays and other types are replaced).</p>

 
  
    <div class='pre p1 fill-light mt0'>setTaskData(args: ...any)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>args</span> <code class='quiet'>(...any)</code>
	    
          </div>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>setTaskData(<span class="hljs-string">'my_bot.magic_number'</span>, <span class="hljs-number">42</span>);</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='getmailbotdata'>
      getMailBotData
    </h3>
    
    
  </div>
  

  <p>Get data stored in mailbot.private_data</p>

 
  
    <div class='pre p1 fill-light mt0'>getMailBotData(key: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>, defaultValue: any)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>key</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>)</code>
	    JSON Path to data from mailbot

          </div>
          
        </div>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>defaultValue</span> <code class='quiet'>(any)</code>
	    If value is undefined, use this value instead

          </div>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>bot.webhook.getMailBotData(<span class="hljs-string">'my_bot.setting'</span>, <span class="hljs-number">42</span>);</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='setmailbotdata'>
      setMailBotData
    </h3>
    
    
  </div>
  

  <p>Set data stored in mailbot.private_data. Objects are shallow merged if
existing data is present. All other values (including arrays) are replaced.</p>
<p>This method has two signatures. It can take an object as its only param
which will be shallowly merged into mailbot.private_data.</p>
<p>It can also take a lodash _.set path as its first parameter and a value
as the second.</p>

 
  
    <div class='pre p1 fill-light mt0'>setMailBotData(args: ...any, param: (<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a> | <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>), value: any?)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>args</span> <code class='quiet'>(...any)</code>
	    
          </div>
          
        </div>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>param</span> <code class='quiet'>((<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a> | <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>))</code>
	    Either a lodash set param or an
object to be shallowly merged into mailbot.private_data

          </div>
          
        </div>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>value</span> <code class='quiet'>(any?)</code>
	    When passing lodash set path string as first
param, this is the value.

          </div>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>bot.webhook.setMailBotData({<span class="hljs-attr">key</span>: <span class="hljs-string">"value"</span>});</pre>
    
      
      <pre class='p1 overflow-auto round fill-light'>bot.webhook.setMailBotData(<span class="hljs-string">'foo.bar'</span>, <span class="hljs-string">"value"</span>);</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='getreferenceemail'>
      getReferenceEmail
    </h3>
    
    
  </div>
  

  <p>Get the reference email ‚Äì¬†the abstract, user-editable instance
of the email associated with this task. Note this is not the same
as the source email (which is the exact email received).</p>

 
  
    <div class='pre p1 fill-light mt0'>getReferenceEmail()</div>
   
  
  

  
  
  
  
  
  

  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>bot.webhook.getReferenceEmail();</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='setreferenceemail'>
      setReferenceEmail
    </h3>
    
    
  </div>
  

  <p>Set reference email
Shallowly merges refernece email fields, allowing
for easy partial updates</p>

 
  
    <div class='pre p1 fill-light mt0'>setReferenceEmail(referenceEmail: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>referenceEmail</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>)</code>
	    
          </div>
          
          <table class='mt1 mb2 fixed-table h5 col-12'>
            <colgroup>
              <col width='30%' />
              <col width='70%' />
            </colgroup>
            <thead>
              <tr class='bold fill-light'>
                <th>Name</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody class='mt1'>
              
                <tr>
  <td class='break-word'><span class='code bold'>referenceEmail.to</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array">array</a></code>
  </td>
  <td class='break-word'><span>Array of email address strings
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>referenceEmail.cc</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array">array</a></code>
  </td>
  <td class='break-word'><span>Array of email address strings
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>referenceEmail.bcc</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array">array</a></code>
  </td>
  <td class='break-word'><span>Array of email address strings
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>referenceEmail.subject</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span>Email subject
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>referenceEmail.reply_to</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span>Email address or action-email
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>referenceEmail.html</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span>html HTML content of email
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>referenceEmail.text</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span>html text-only content of email
</span></td>
</tr>


              
            </tbody>
          </table>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>bot.webhook.setReferenceEmail({
  <span class="hljs-attr">to</span>: <span class="hljs-string">"test@gmail.com"</span>,
  <span class="hljs-attr">subject</span>: <span class="hljs-string">"A new subject"</span>,
  <span class="hljs-attr">html</span>: <span class="hljs-string">"This new content replaces the old"</span>
});</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='getreplyto'>
      getReplyTo
    </h3>
    
    
  </div>
  

  <p>Get replyto email, taking into this value being edited
after the original email was sent.</p>

 
  
    <div class='pre p1 fill-light mt0'>getReplyTo()</div>
   
  
  

  
  
  
  
  
  

  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>bot.webhook.getReplyTo();</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='getemailmethod'>
      getEmailMethod
    </h3>
    
    
  </div>
  

  <p>Determine if the email command for the current task was placed in the 'to', 'cc' or 'bcc'
fields. This is done by comparing the email command with the email address in the  and 'to', 'cc'
fields. The 'bcc' is hidden from the message envelope but still present in the command.</p>
<p>Note that if the identical email command is in both 'to', 'cc' and 'bcc' it will
only show up as the 'to' method.</p>

 
  
    <div class='pre p1 fill-light mt0'>getEmailMethod()</div>
   
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='sendemail'>
      sendEmail
    </h3>
    
    
  </div>
  

  <p>Sends an email by adding an email message object to the "send_messages" array.
Multiple emails can be sent.</p>

 
  
    <div class='pre p1 fill-light mt0'>sendEmail(email: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>): <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>email</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>)</code>
	    email object

          </div>
          
          <table class='mt1 mb2 fixed-table h5 col-12'>
            <colgroup>
              <col width='30%' />
              <col width='70%' />
            </colgroup>
            <thead>
              <tr class='bold fill-light'>
                <th>Name</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody class='mt1'>
              
                <tr>
  <td class='break-word'><span class='code bold'>email.to</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span>comma separated emails
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>email.cc</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span>comma separated emails
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>email.bcc</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span>comma separated emails
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>email.from</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span>from name only (message-envelope is always from mailbots)
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>email.reply_to</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span>email address or action-email
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>email.subject</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span>email subject
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>email.body</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array">array</a></code>
  </td>
  <td class='break-word'><span>Array of ui objects 
<a href="https://docs.mailbots.com/docs/email-ui-reference">https://docs.mailbots.com/docs/email-ui-reference</a>
</span></td>
</tr>


              
            </tbody>
          </table>
          
        </div>
      
    </div>
  

  

  
    
      <div class='py1 quiet mt1 prose-big'>Returns</div>
      <code><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></code>:
        A reference to the email object for additional changes

      
    
  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'><span class="hljs-keyword">const</span> email = bot.webhook.sendEmail({
  <span class="hljs-attr">to</span>: bot.get(<span class="hljs-string">'source.from'</span>),
  <span class="hljs-attr">subject</span>: <span class="hljs-string">"A Subject"</span>,
  <span class="hljs-attr">body</span>: [
  {
   <span class="hljs-attr">type</span>: <span class="hljs-string">'html'</span>,
   <span class="hljs-attr">text</span>: <span class="hljs-string">'&lt;h1&gt;An email&lt;/h1&gt;'</span>
  }];
})

email.from = <span class="hljs-string">"New Sender"</span>; <span class="hljs-comment">// still updatable</span></pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='quickreply'>
      quickReply
    </h3>
    
    
  </div>
  

  <p>Shorthand method to send a quick reply back to the "from" address
of the incoming email. This accepts either a string or object.
If passing a strong only, the subject and body share the same
text. Pass and object iwth <code>{subject, body}</code> to explicitly set
the subject and body</p>

 
  
    <div class='pre p1 fill-light mt0'>quickReply(message: (<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a> | <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>))</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>message</span> <code class='quiet'>((<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a> | <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>))</code>
	    Content

          </div>
          
          <table class='mt1 mb2 fixed-table h5 col-12'>
            <colgroup>
              <col width='30%' />
              <col width='70%' />
            </colgroup>
            <thead>
              <tr class='bold fill-light'>
                <th>Name</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody class='mt1'>
              
                <tr>
  <td class='break-word'><span class='code bold'>message.subject</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>?</code>
  </td>
  <td class='break-word'><span>passing an object
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>message.body</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>?</code>
  </td>
  <td class='break-word'><span>If passing an object
</span></td>
</tr>


              
            </tbody>
          </table>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>bot.webhook.quickReply(<span class="hljs-string">"Got it!"</span>);</pre>
    
      
      <pre class='p1 overflow-auto round fill-light'>botRequest.webhook.quickReply({
   <span class="hljs-attr">subject</span>: <span class="hljs-string">"Quick reply subject"</span>,
   <span class="hljs-attr">body</span>: [{
     <span class="hljs-attr">type</span>: <span class="hljs-string">"title"</span>,
     <span class="hljs-attr">text</span>: <span class="hljs-string">"Welcome"</span>,
   },
   {
     <span class="hljs-attr">type</span>: <span class="hljs-string">"button"</span>,
     <span class="hljs-attr">behavior</span>: <span class="hljs-string">"url"</span>,
     <span class="hljs-attr">text</span>: <span class="hljs-string">"Press Me"</span>,
     <span class="hljs-attr">url</span>: <span class="hljs-string">"google.com"</span>
   }]
 });</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='settriggertime'>
      setTriggerTime
    </h3>
    
    
  </div>
  

  <p>Set trigger time for a task using natural language</p>

 
  
    <div class='pre p1 fill-light mt0'>setTriggerTime(time: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>time</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>)</code>
	    FollowUpThen-style time description

          </div>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>bot.webhook.setTriggerTime(<span class="hljs-string">"monday"</span>);</pre>
    
      
      <pre class='p1 overflow-auto round fill-light'>bot.webhook.setTriggerTime(<span class="hljs-string">"every2ndWeds"</span>);</pre>
    
      
      <pre class='p1 overflow-auto round fill-light'>bot.webhook.setTriggerTime(<span class="hljs-string">"everyTuesday2pm"</span>);</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='settriggertimestamp'>
      setTriggerTimestamp
    </h3>
    
    
  </div>
  

  <p>Set trigger time for a task using a unix timestamp</p>

 
  
    <div class='pre p1 fill-light mt0'>setTriggerTimestamp(timestamp: int)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>timestamp</span> <code class='quiet'>(int)</code>
	    Unix timestamp of trigger time

          </div>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>bot.webhook.setTriggerTimestamp(<span class="hljs-number">1546139899</span>);</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='invite'>
      invite
    </h3>
    
    
  </div>
  

  <p>Trigger MailBots to invite the given email address(es) to use a bot</p>

 
  
    <div class='pre p1 fill-light mt0'>invite(invitees: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array">array</a>)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>invitees</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array">array</a>)</code>
	    Array of email addresses

          </div>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>bot.webhook.invite([<span class="hljs-string">'user1@email.com'</span>,<span class="hljs-string">'newUser2@gmail.com'</span>]);</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='completetask'>
      completeTask
    </h3>
    
    
  </div>
  

  <p>Mark task a completed. The task will be archived until permenantly deleted.</p>

 
  
    <div class='pre p1 fill-light mt0'>completeTask()</div>
   
  
  

  
  
  
  
  
  

  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>bot.webhook.completeTask();</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='getallcontacts'>
      getAllContacts
    </h3>
    
    
  </div>
  

  <p>Fetch all contacts associated with the task's reference_email. User's
address and MailBots addresses are excluded.</p>
<p>Note: This uses reference_email, allowing a user to add
or remove additional recipients from the task.</p>

 
  
    <div class='pre p1 fill-light mt0'>getAllContacts(): <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array">array</a></div>
   
  
  

  
  
  
  
  
  

  

  

  
    
      <div class='py1 quiet mt1 prose-big'>Returns</div>
      <code><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array">array</a></code>:
        Email addresses

      
    
  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>bot.webhook.getAllContacts();</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='respond'>
      respond
    </h3>
    
    
  </div>
  

  <p>Respond to (and end) the webhook response with the JSON provided.
Multi-fire handlers (like onSettingsViewed) automatically respond.
In the case where an error-condition causes an early return / response
calling this method prevents the handler from trying to return a
second time. Provided JSON is shallowly merged into response object.</p>

 
  
    <div class='pre p1 fill-light mt0'>respond(json: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>json</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>)</code>
	    Response JSON

          </div>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>bot.webhook.respond();</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='settingspage'>
      settingsPage
    </h3>
    
    
  </div>
  

  <p>Creates a new settings page, rendered in the WebhookHelpers Settings section
of the Admin UI. See SettingsPage docs for details</p>

 
  
    <div class='pre p1 fill-light mt0'>settingsPage(params: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>params</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>)</code>
	    
          </div>
          
          <table class='mt1 mb2 fixed-table h5 col-12'>
            <colgroup>
              <col width='30%' />
              <col width='70%' />
            </colgroup>
            <thead>
              <tr class='bold fill-light'>
                <th>Name</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody class='mt1'>
              
                <tr>
  <td class='break-word'><span class='code bold'>params.namespace</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span>Namespace used on mailbot.private_data
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.title</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  
    (default <code>&quot;&quot;</code>)
  </td>
  <td class='break-word'><span>Page title
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.menuTitle</span> <code class='quiet'>menuTitle</code>
  </td>
  <td class='break-word'><span>Menu item title
</span></td>
</tr>


              
            </tbody>
          </table>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'><span class="hljs-keyword">const</span>.settingsPage = bot.webhook.settingsPage({
  <span class="hljs-attr">namespace</span>: <span class="hljs-string">"mem"</span>,
  <span class="hljs-attr">title</span>: <span class="hljs-string">"Memorization Settings"</span>,
  <span class="hljs-attr">menuTitle</span>: <span class="hljs-string">"Memorization"</span>
});</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='botwebooksettingspage'>
      bot.webook.settingsPage
    </h3>
    
    
  </div>
  

  <p>Reference for <code>bot.webhook.settingsPage()</code> </p>
<p> Bots and bot skills can create settings settings pages which live
in <code>responseJson.settings[namespace]</code>. This class represents one
such settings form. Each settings form lives in its own namespace.
Instantiating a new SettingsPage adds a new namespace to
<code>responseJson.settings</code> key and populates it with React JSON Form
Schema JSON. <a href="https://github.com/mozilla-services/react-jsonschema-form">https://github.com/mozilla-services/react-jsonschema-form</a>
The MailBots Admin UI loops through namespaces, rendering forms appropriately.</p>
<p>NOTE: This class directly mutates MailBot's response JSON to add
settings pages and form fields.</p>

 
  
    <div class='pre p1 fill-light mt0'>bot.webook.settingsPage</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>params</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>)</code>
	    Object params

          </div>
          
          <table class='mt1 mb2 fixed-table h5 col-12'>
            <colgroup>
              <col width='30%' />
              <col width='70%' />
            </colgroup>
            <thead>
              <tr class='bold fill-light'>
                <th>Name</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody class='mt1'>
              
                <tr>
  <td class='break-word'><span class='code bold'>params.responseJson</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></code>
  </td>
  <td class='break-word'><span>Reference to MailBots responseJson obj
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.title</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span>Display title of settings page
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.menuTitle</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span>Menu name
</span></td>
</tr>


              
            </tbody>
          </table>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'><span class="hljs-keyword">const</span> mySettingsPage = bot.webhook.settingsPage({
 <span class="hljs-attr">namespace</span>: <span class="hljs-string">"memorize"</span>,
 <span class="hljs-attr">title</span>: <span class="hljs-string">"Memorization Settings"</span>,
 <span class="hljs-attr">menuTitle</span>: <span class="hljs-string">"Memorization"</span>
});

<span class="hljs-comment">// Add elements to the page</span>
mySettingsPage.input({ <span class="hljs-attr">name</span>: <span class="hljs-string">"first_name"</span>}); <span class="hljs-comment">// renders text input</span></pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='getsettingsformjson'>
      getSettingsFormJSON
    </h3>
    
    
  </div>
  

  <p>Retrieve the JSON Form Schema for this form</p>

 
  
    <div class='pre p1 fill-light mt0'>getSettingsFormJSON(): <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></div>
   
  
  

  
  
  
  
  
  

  

  

  
    
      <div class='py1 quiet mt1 prose-big'>Returns</div>
      <code><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></code>:
        JSON Form Schema

      
    
  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'><span class="hljs-keyword">const</span> thisJsonSchema = settingsForm.getSettingsFormJSON();</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='insert'>
      insert
    </h3>
    
    
  </div>
  

  <p>Low-level function to insert raw JSONSchema and uiSchema to
create custom form elements.
Mozilla's React JSON Schema Form manages the form JSON and
UI JSON as two separate objects to keep the form JSON prestine and
compliant. This method lets us manage a form element in one place.
Ref: <a href="https://github.com/mozilla-services/react-jsonschema-form">https://github.com/mozilla-services/react-jsonschema-form</a></p>

 
  
    <div class='pre p1 fill-light mt0'>insert(params: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>params</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>)</code>
	    
          </div>
          
          <table class='mt1 mb2 fixed-table h5 col-12'>
            <colgroup>
              <col width='30%' />
              <col width='70%' />
            </colgroup>
            <thead>
              <tr class='bold fill-light'>
                <th>Name</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody class='mt1'>
              
                <tr>
  <td class='break-word'><span class='code bold'>params.name</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></code>
  </td>
  <td class='break-word'><span>Namespace
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.JSONSchema</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></code>
  </td>
  <td class='break-word'><span>JSON Schema
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.uiSchema</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></code>
  </td>
  <td class='break-word'><span>Corresponding uiSchema
<p>This example is taken from <a href="https://mozilla-services.github.io/react-jsonschema-form/">https://mozilla-services.github.io/react-jsonschema-form/</a></p>
</span></td>
</tr>


              
            </tbody>
          </table>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>formPage.insert({
<span class="hljs-attr">name</span>: <span class="hljs-string">"first_name"</span>,
<span class="hljs-attr">JSONSchema</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">"First name"</span> }, <span class="hljs-comment">// JSON Schema</span>
uiSchema: { <span class="hljs-string">"ui:autofocus"</span>: <span class="hljs-literal">true</span>, <span class="hljs-string">"ui:emptyValue"</span>: <span class="hljs-string">""</span> } <span class="hljs-comment">// UI Schema</span>
});</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='input'>
      input
    </h3>
    
    
  </div>
  

  <p>Add text input field</p>

 
  
    <div class='pre p1 fill-light mt0'>input(params: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>params</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>)</code>
	    
          </div>
          
          <table class='mt1 mb2 fixed-table h5 col-12'>
            <colgroup>
              <col width='30%' />
              <col width='70%' />
            </colgroup>
            <thead>
              <tr class='bold fill-light'>
                <th>Name</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody class='mt1'>
              
                <tr>
  <td class='break-word'><span class='code bold'>params.name</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.title</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.description</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.helpText</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.placeholder</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.defaultValue</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
            </tbody>
          </table>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>formPage.input({
  <span class="hljs-attr">name</span>: <span class="hljs-string">"first_name"</span>,
  <span class="hljs-attr">title</span>:<span class="hljs-string">"First Name"</span>
  description: <span class="hljs-string">"Type your first name"</span>,
  <span class="hljs-attr">helpText</span>: <span class="hljs-string">"Hopefully you don't need help with this"</span>,
  <span class="hljs-attr">placeholder</span>: <span class="hljs-string">"(Ex: Bruce Lee)"</span>,
  <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">"John Doe"</span>,
});</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='textarea'>
      textarea
    </h3>
    
    
  </div>
  

  <p>Add textarea input</p>

 
  
    <div class='pre p1 fill-light mt0'>textarea(params: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>params</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>)</code>
	    
          </div>
          
          <table class='mt1 mb2 fixed-table h5 col-12'>
            <colgroup>
              <col width='30%' />
              <col width='70%' />
            </colgroup>
            <thead>
              <tr class='bold fill-light'>
                <th>Name</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody class='mt1'>
              
                <tr>
  <td class='break-word'><span class='code bold'>params.name</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.title</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.description</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.helpText</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.placeholder</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.defaultValue</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
            </tbody>
          </table>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>formPage.textarea({
  <span class="hljs-attr">name</span>: <span class="hljs-string">"life_story"</span>,
  <span class="hljs-attr">title</span>:<span class="hljs-string">"Life Story"</span>,
  <span class="hljs-attr">description</span>: <span class="hljs-string">"This is a long story"</span>,
  <span class="hljs-attr">helpText</span>: <span class="hljs-string">"Just start writing"</span>,
  <span class="hljs-attr">placeholder</span>: <span class="hljs-string">"Once upon a time..."</span>,
  <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">"I was born, some time passed, now I'm here"</span>
});</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='checkbox'>
      checkbox
    </h3>
    
    
  </div>
  

  <p>Add checkbox field</p>

 
  
    <div class='pre p1 fill-light mt0'>checkbox(params: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>params</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>)</code>
	    
          </div>
          
          <table class='mt1 mb2 fixed-table h5 col-12'>
            <colgroup>
              <col width='30%' />
              <col width='70%' />
            </colgroup>
            <thead>
              <tr class='bold fill-light'>
                <th>Name</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody class='mt1'>
              
                <tr>
  <td class='break-word'><span class='code bold'>params.name</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.title</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.description</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.helpText</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.defaultValue</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
            </tbody>
          </table>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>formPage.checkbox({ <span class="hljs-attr">name</span>:<span class="hljs-string">"confirmation_emails"</span>, <span class="hljs-attr">title</span>:<span class="hljs-string">"Confirmation Emails"</span>});</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='select'>
      select
    </h3>
    
    
  </div>
  

  <p>Add select dropdown</p>

 
  
    <div class='pre p1 fill-light mt0'>select(params: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>params</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>)</code>
	    
          </div>
          
          <table class='mt1 mb2 fixed-table h5 col-12'>
            <colgroup>
              <col width='30%' />
              <col width='70%' />
            </colgroup>
            <thead>
              <tr class='bold fill-light'>
                <th>Name</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody class='mt1'>
              
                <tr>
  <td class='break-word'><span class='code bold'>params.name</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.title</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.description</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.helpText</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.options</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array">array</a></code>
  </td>
  <td class='break-word'><span>Array of options
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.placeholder</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span>// when no option is selected
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.defaultValue</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
            </tbody>
          </table>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>settingsPage.select({
  <span class="hljs-attr">name</span>: <span class="hljs-string">"favorite_color"</span>,
  <span class="hljs-attr">title</span>: <span class="hljs-string">"Favorite Color"</span>,
  <span class="hljs-attr">description</span>: <span class="hljs-string">"Which color do you like the best?"</span>,
  <span class="hljs-attr">helpText</span>: <span class="hljs-string">"Choose a color"</span>,
  <span class="hljs-attr">options</span>: [<span class="hljs-string">"red"</span>, <span class="hljs-string">"green"</span>, <span class="hljs-string">"blue"</span>],
  <span class="hljs-attr">defaultValue</span>: <span class="hljs-string">"blue"</span>,
  <span class="hljs-attr">placeholder</span>: <span class="hljs-string">"Pick one!"</span>
 });</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='alert'>
      alert
    </h3>
    
    
  </div>
  

  <p>Adds a custom dialog at the top of the display form that can be used
for interrupt-messaging.</p>

 
  
    <div class='pre p1 fill-light mt0'>alert(params: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>params</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>)</code>
	    
          </div>
          
          <table class='mt1 mb2 fixed-table h5 col-12'>
            <colgroup>
              <col width='30%' />
              <col width='70%' />
            </colgroup>
            <thead>
              <tr class='bold fill-light'>
                <th>Name</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody class='mt1'>
              
                <tr>
  <td class='break-word'><span class='code bold'>params.title</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span>Alert box title
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.text</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span>Alert box text
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.linkText</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span>Action button link text
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.linkHref</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span>URL of button
</span></td>
</tr>


              
            </tbody>
          </table>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>formPage.alert({
  <span class="hljs-attr">title</span>: <span class="hljs-string">"Connect"</span>,
  <span class="hljs-attr">text</span>: <span class="hljs-string">"Connect GitHub"</span>,
  <span class="hljs-attr">linkText</span>: <span class="hljs-string">"Connect"</span>,
  <span class="hljs-attr">linkHref</span>: <span class="hljs-string">"https://www.github.com"</span>
})</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='video'>
      video
    </h3>
    
    
  </div>
  

  <p>Insert Video. Only YouTube supported for now.</p>

 
  
    <div class='pre p1 fill-light mt0'>video(params: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>params</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>)</code>
	    
          </div>
          
          <table class='mt1 mb2 fixed-table h5 col-12'>
            <colgroup>
              <col width='30%' />
              <col width='70%' />
            </colgroup>
            <thead>
              <tr class='bold fill-light'>
                <th>Name</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody class='mt1'>
              
                <tr>
  <td class='break-word'><span class='code bold'>params.url</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  
    (default <code>&quot;&quot;</code>)
  </td>
  <td class='break-word'><span>URL of video
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.type</span> <code class='quiet'>any</code>
  
    (default <code>&quot;youtube&quot;</code>)
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
            </tbody>
          </table>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>formPage.video({
  <span class="hljs-attr">url</span>: <span class="hljs-string">"https://www.youtube.com/watch?v=y1GyXuU2J5k"</span>,
  <span class="hljs-attr">type</span>: <span class="hljs-string">"youtube"</span>
})</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='text'>
      text
    </h3>
    
    
  </div>
  

  <p>Add a text block. Markdown supported!</p>

 
  
    <div class='pre p1 fill-light mt0'>text(text: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>text</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>)</code>
	    ‚Äì Text with optional markdown
<p>Note: This field is whitespace sensitive. New lines
cannot have leading spaces.</p>

          </div>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>formPage.text(<span class="hljs-string">`--------------
## Ô∏è‚ö†Ô∏è Connect Github
This is a text block here. Leading spaces can break this.
And this is a new line.

[Connect Github](http://www.google.com)

------------------
`</span>);</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='hiddeninput'>
      hiddenInput
    </h3>
    
    
  </div>
  

  <p>Render a hidden input field. Useful for submitting
values behind the scenes.</p>

 
  
    <div class='pre p1 fill-light mt0'>hiddenInput(params: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>params</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>)</code>
	    
          </div>
          
          <table class='mt1 mb2 fixed-table h5 col-12'>
            <colgroup>
              <col width='30%' />
              <col width='70%' />
            </colgroup>
            <thead>
              <tr class='bold fill-light'>
                <th>Name</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody class='mt1'>
              
                <tr>
  <td class='break-word'><span class='code bold'>params.name</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span>Field name
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.value</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span>Field value
</span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.defaultValue</span> <code class='quiet'>any</code>
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
            </tbody>
          </table>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>formPage.hiddenInput({
  <span class="hljs-attr">name</span>: <span class="hljs-string">"key"</span>,
  <span class="hljs-attr">value</span>: <span class="hljs-string">"value"</span>
});</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='submitbutton'>
      submitButton
    </h3>
    
    
  </div>
  

  <p>Render a submit button for the form. (Submit button is not included
automatically). URL params can optionally be passed which makes
them available to the next handler. Make sure to validate URL input.</p>

 
  
    <div class='pre p1 fill-light mt0'>submitButton(params: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>params</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>
            = <code>{}</code>)</code>
	    
          </div>
          
          <table class='mt1 mb2 fixed-table h5 col-12'>
            <colgroup>
              <col width='30%' />
              <col width='70%' />
            </colgroup>
            <thead>
              <tr class='bold fill-light'>
                <th>Name</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody class='mt1'>
              
                <tr>
  <td class='break-word'><span class='code bold'>params.submitText</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></code>
  </td>
  <td class='break-word'><span></span></td>
</tr>


              
                <tr>
  <td class='break-word'><span class='code bold'>params.urlParams</span> <code class='quiet'><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></code>
  </td>
  <td class='break-word'><span>Key value of url params
</span></td>
</tr>


              
            </tbody>
          </table>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'>formPage.submitButton({
  <span class="hljs-attr">submitText</span>: <span class="hljs-string">"Save Settings"</span>,
  <span class="hljs-attr">urlParams</span>: { <span class="hljs-attr">key</span>: <span class="hljs-string">"value"</span> }
});</pre>
    
  

  

  

  
</section>

        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='populate'>
      populate
    </h3>
    
    
  </div>
  

  <p>Populate form data, overwriting default values with those newly passed.
MailBots JSON form data for this namespace can be passed directly to this
method to populate the form values.</p>

 
  
    <div class='pre p1 fill-light mt0'>populate(formData: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>)</div>
   
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>formData</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>)</code>
	    JSON object containing form values.

          </div>
          
        </div>
      
    </div>
  

  

  

  

  
    <div class='py1 quiet mt1 prose-big'>Example</div>
    
      
      <pre class='p1 overflow-auto round fill-light'><span class="hljs-keyword">const</span> storedData = mailbots.webhook.getMailBotData(<span class="hljs-string">"mem"</span>, {});
formPage.populate(storedData);</pre>
    
  

  

  

  
</section>

        
      </div>
    </div>
  <script src='assets/anchor.js'></script>
  <script src='assets/split.js'></script>
  <script src='assets/site.js'></script>
</body>
</html>
